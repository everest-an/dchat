
# Dchat.pro ç”Ÿäº§çº§åŠŸèƒ½æµ‹è¯•ä¸åˆ†ææŠ¥å‘Š

## é¡¹ç›®æ¦‚å†µ

**é¡¹ç›®åç§°**: Dchat - Secure Business Communication Platform  
**å®šä½**: Web3 å»ä¸­å¿ƒåŒ–å•†ä¸šé€šä¿¡å¹³å°  
**ç«äº‰ç›®æ ‡**: ä¸ Elon Musk çš„èŠå¤©è½¯ä»¶å’Œ Telegram ç«äº‰  
**æŠ€æœ¯æ ˆ**: React + Flask + Solidity + Ethereum  
**æµ‹è¯•æ—¥æœŸ**: 2025-11-04

---

## ä¸€ã€å‰ç«¯åŠŸèƒ½æµ‹è¯•ç»“æœ

### 1.1 ç™»å½•é¡µé¢åŠŸèƒ½

**å·²å®ç°åŠŸèƒ½**ï¼š

ç™»å½•é¡µé¢æä¾›äº†ä¸‰ç§ç™»å½•æ–¹å¼ï¼Œç•Œé¢è®¾è®¡ç®€æ´ä¸“ä¸šã€‚MetaMask é’±åŒ…ç™»å½•æ˜¯ä¸»è¦æ¨èæ–¹å¼ï¼Œç¬¦åˆ Web3 å®šä½ã€‚Email å’Œ Phone ç™»å½•ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆï¼Œé™ä½äº†ç”¨æˆ·è¿›å…¥é—¨æ§›ã€‚é¡µé¢åŒ…å«äº†ç«¯åˆ°ç«¯åŠ å¯†ã€æŠ—é‡å­åŠ å¯†å’ŒåŒºå—é“¾å­˜å‚¨çš„å®‰å…¨ç‰¹æ€§è¯´æ˜ï¼Œå¹¶æä¾›äº†æœåŠ¡æ¡æ¬¾å’Œéšç§æ”¿ç­–é“¾æ¥ã€‚

**Email ç™»å½•æµç¨‹**åŒ…å«å®Œæ•´çš„è¡¨å•éªŒè¯ï¼Œæ”¯æŒå¯†ç å¯è§æ€§åˆ‡æ¢ï¼Œæä¾›äº†æ³¨å†Œå…¥å£å’Œå¯†ç é‡ç½®åŠŸèƒ½ï¼Œå¹¶åœ¨åº•éƒ¨æ˜¾ç¤ºäº†å¯†ç åŠ å¯†å­˜å‚¨çš„å®‰å…¨æç¤ºã€‚

**æ³¨å†Œæµç¨‹**è®¾è®¡åˆç†ï¼ŒåŒ…å«å¯é€‰çš„ç”¨æˆ·åå­—æ®µã€å¿…å¡«çš„é‚®ç®±å’Œå¯†ç å­—æ®µï¼Œå¯†ç ç¡®è®¤åŠŸèƒ½ï¼Œä»¥åŠè¿”å›ç™»å½•çš„å…¥å£ã€‚

**Phone ç™»å½•**æä¾›äº†å›½é™…ç”µè¯å·ç æ ¼å¼è¾“å…¥ï¼Œè¯´æ˜ä¼šè‡ªåŠ¨åˆ›å»ºå®‰å…¨é’±åŒ…ï¼Œä½†æœªæµ‹è¯•å®é™…éªŒè¯ç å‘é€åŠŸèƒ½ã€‚

**åŠŸèƒ½å®Œå–„åº¦è¯„ä¼°**ï¼š
- âœ… ä¸‰ç§ç™»å½•æ–¹å¼ç•Œé¢å®Œæ•´
- âœ… è¡¨å•éªŒè¯å’Œç”¨æˆ·ä½“éªŒè‰¯å¥½
- âš ï¸ æœªæµ‹è¯•å®é™…ç™»å½•åŠŸèƒ½ï¼ˆéœ€è¦çœŸå®è´¦å·ï¼‰
- âš ï¸ MetaMask è¿æ¥åŠŸèƒ½æœªéªŒè¯
- âš ï¸ æ‰‹æœºéªŒè¯ç å‘é€åŠŸèƒ½æœªéªŒè¯

### 1.2 ä¸»é¡µåŠŸèƒ½

**å·²å®ç°åŠŸèƒ½**ï¼š

ä¸»é¡µé‡‡ç”¨ç°ä»£åŒ–çš„è¥é”€é¡µé¢è®¾è®¡ï¼Œæ¸…æ™°å±•ç¤ºäº†äº§å“çš„å…­å¤§æ ¸å¿ƒç‰¹æ€§ã€‚é¡µé¢åŒ…å«æ˜ç¡®çš„è¡ŒåŠ¨å·å¬æŒ‰é’®ï¼Œè§†è§‰è®¾è®¡ä¸“ä¸šï¼Œå“åº”å¼å¸ƒå±€è‰¯å¥½ã€‚

**æ ¸å¿ƒç‰¹æ€§å±•ç¤º**ï¼š
- End-to-End Encryptionï¼ˆç«¯åˆ°ç«¯åŠ å¯†ï¼‰
- Blockchain Storageï¼ˆåŒºå—é“¾å­˜å‚¨ï¼‰
- Instant Paymentï¼ˆå³æ—¶æ”¯ä»˜ï¼‰
- Professional Networkï¼ˆLinkedIn é›†æˆï¼‰
- Web3 Nativeï¼ˆWeb3 åŸç”Ÿï¼‰
- Smart Collaborationï¼ˆæ™ºèƒ½åä½œï¼‰

**åŠŸèƒ½å®Œå–„åº¦è¯„ä¼°**ï¼š
- âœ… è¥é”€é¡µé¢è®¾è®¡ä¸“ä¸š
- âœ… æ ¸å¿ƒä»·å€¼ä¸»å¼ æ¸…æ™°
- âœ… å“åº”å¼è®¾è®¡è‰¯å¥½
- âš ï¸ ç¼ºå°‘äº§å“æ¼”ç¤ºè§†é¢‘
- âš ï¸ ç¼ºå°‘å®¢æˆ·æ¡ˆä¾‹å’Œç¤¾ä¼šè¯æ˜
- âš ï¸ ç¼ºå°‘å®šä»·ä¿¡æ¯

---

## äºŒã€åç«¯ä»£ç æ¶æ„åˆ†æ

### 2.1 æŠ€æœ¯æ¶æ„æ¦‚è§ˆ

**åç«¯æŠ€æœ¯æ ˆ**ï¼š
- **æ¡†æ¶**: Flask (Python)
- **æ•°æ®åº“**: SQLite (å¼€å‘) / PostgreSQL (ç”Ÿäº§) / Supabase (å·²è¿ç§»)
- **è®¤è¯**: JWT Bearer Token
- **å®æ—¶é€šä¿¡**: Socket.IO (å·²å®ç°ä½†å¯èƒ½æœªéƒ¨ç½²)
- **åŒºå—é“¾**: Web3.py + ethers.js
- **æ™ºèƒ½åˆçº¦**: Solidity 0.8.x (Sepolia Testnet)

**å‰ç«¯æŠ€æœ¯æ ˆ**ï¼š
- **æ¡†æ¶**: React 18 + Vite
- **æ ·å¼**: Tailwind CSS
- **çŠ¶æ€ç®¡ç†**: React Context API
- **Web3**: ethers.js
- **æ„å»ºå·¥å…·**: Vite

### 2.2 æ•°æ®åº“æ¨¡å‹åˆ†æ

**User æ¨¡å‹** (åŸºç¡€ä½†ä¸å®Œæ•´)ï¼š
```python
- id: Integer (ä¸»é”®)
- wallet_address: String(42) (å”¯ä¸€, å¿…å¡«)
- name: String(100) (å¿…å¡«)
- company: String(200) (å¯é€‰)
- position: String(200) (å¯é€‰)
- linkedin_id: String(100) (å¯é€‰)
- public_key: Text (å¯é€‰)
- created_at: DateTime
- updated_at: DateTime
```

**ç¼ºå¤±å­—æ®µ**ï¼š
- âŒ å¤´åƒ/ä¸ªäººç…§ç‰‡
- âŒ é‚®ç®±åœ°å€ï¼ˆä»…æ”¯æŒé’±åŒ…ç™»å½•ï¼‰
- âŒ æ‰‹æœºå·ç 
- âŒ ç”¨æˆ·çŠ¶æ€ï¼ˆåœ¨çº¿/ç¦»çº¿/å¿™ç¢Œï¼‰
- âŒ æœ€åæ´»è·ƒæ—¶é—´
- âŒ ç”¨æˆ·è§’è‰²/æƒé™
- âŒ è´¦æˆ·çŠ¶æ€ï¼ˆæ¿€æ´»/ç¦ç”¨/åˆ é™¤ï¼‰
- âŒ é‚®ç®±/æ‰‹æœºéªŒè¯çŠ¶æ€

**Message æ¨¡å‹** (åŸºç¡€å®ç°)ï¼š
```python
- id: Integer (ä¸»é”®)
- sender_id: Integer (å¤–é”®)
- receiver_id: Integer (å¤–é”®)
- content: Text (å¿…å¡«)
- encrypted_content: Text (å¯é€‰, ä½†æœªä½¿ç”¨)
- message_type: String(20) (é»˜è®¤ 'text')
- ipfs_hash: String(100) (å¯é€‰, æœªå®ç°)
- timestamp: DateTime
- is_read: Boolean (é»˜è®¤ False)
```

**ä¸¥é‡é—®é¢˜**ï¼š
- âŒ encrypted_content å­—æ®µå­˜åœ¨ä½†ä»æœªä½¿ç”¨
- âŒ ipfs_hash å­—æ®µå­˜åœ¨ä½† IPFS æœªé›†æˆ
- âŒ ç¼ºå°‘æ¶ˆæ¯çŠ¶æ€ï¼ˆå‘é€ä¸­/å·²é€è¾¾/å·²è¯»/å¤±è´¥ï¼‰
- âŒ ç¼ºå°‘æ¶ˆæ¯ç¼–è¾‘/åˆ é™¤æ—¶é—´æˆ³
- âŒ ç¼ºå°‘å›å¤å¼•ç”¨å­—æ®µ
- âŒ ç¼ºå°‘ç¾¤ç»„æ¶ˆæ¯æ”¯æŒ
- âŒ ç¼ºå°‘æ¶ˆæ¯é™„ä»¶å…³è”

**Project æ¨¡å‹** (å­˜åœ¨ä½†æœªè¯¦ç»†å®¡æŸ¥)ï¼š
- æ”¯æŒé¡¹ç›®ç®¡ç†å’Œåä½œ
- åŒ…å« Momentï¼ˆåŠ¨æ€ï¼‰åŠŸèƒ½
- å…·ä½“å®ç°ç»†èŠ‚éœ€è¿›ä¸€æ­¥å®¡æŸ¥

### 2.3 API è·¯ç”±åˆ†æ

**è®¤è¯è·¯ç”±** (`/api/auth`):

å®ç°äº†ä¸‰ä¸ªåŸºç¡€ç«¯ç‚¹ï¼Œä½†å­˜åœ¨ä¸¥é‡çš„å®‰å…¨æ¼æ´ã€‚`connect-wallet` ç«¯ç‚¹æ¥å—é’±åŒ…åœ°å€å’Œç­¾åï¼Œä½†**ç­¾åéªŒè¯å®Œå…¨ç¼ºå¤±**ï¼Œä»»ä½•äººéƒ½å¯ä»¥ä¼ªé€ é’±åŒ…åœ°å€ç™»å½•ã€‚ç”¨æˆ·åè‡ªåŠ¨ç”Ÿæˆä¸º"ç”¨æˆ·+åœ°å€å6ä½"ï¼Œç¼ºä¹ä¸ªæ€§åŒ–ã€‚JWT token æœ‰æ•ˆæœŸä¸º 30 å¤©ï¼Œä½†æ²¡æœ‰åˆ·æ–°æœºåˆ¶ã€‚

**ä¸¥é‡å®‰å…¨é—®é¢˜**ï¼š
```python
# auth.py ç¬¬ 18 è¡Œ
signature = data.get('signature')  # è·å–ç­¾åä½†ä»æœªéªŒè¯ï¼
```

**ç¼ºå¤±åŠŸèƒ½**ï¼š
- âŒ ç­¾åéªŒè¯ï¼ˆè‡´å‘½å®‰å…¨æ¼æ´ï¼‰
- âŒ Nonce ç®¡ç†ï¼ˆé˜²æ­¢é‡æ”¾æ”»å‡»ï¼‰
- âŒ Token åˆ·æ–°æœºåˆ¶
- âŒ ç™»å‡ºç«¯ç‚¹ï¼ˆè™½ç„¶å‰ç«¯æœ‰ AuthServiceï¼‰
- âŒ å¯†ç ç™»å½•ï¼ˆè™½ç„¶å‰ç«¯æœ‰ç•Œé¢ï¼‰
- âŒ æ‰‹æœºéªŒè¯ç ç™»å½•
- âŒ å¤šå› ç´ è®¤è¯
- âŒ ä¼šè¯ç®¡ç†
- âŒ ç™»å½•å†å²è®°å½•

**æ¶ˆæ¯è·¯ç”±** (`/api/messages`):

å®ç°äº†åŸºç¡€çš„æ¶ˆæ¯å‘é€å’Œè·å–åŠŸèƒ½ï¼Œä½†å­˜åœ¨å¤šä¸ªä¸¥é‡é—®é¢˜ã€‚`get_conversations` ç«¯ç‚¹çš„æœªè¯»è®¡æ•°ç¡¬ç¼–ç ä¸º 0ï¼Œå®é™…æœªå®ç°è®¡æ•°é€»è¾‘ã€‚`encrypt_message` å’Œ `decrypt_message` ç«¯ç‚¹åªæ˜¯ç®€å•çš„ base64 ç¼–ç ï¼Œ**ä¸æ˜¯çœŸæ­£çš„åŠ å¯†**ã€‚

**ä¸¥é‡é—®é¢˜**ï¼š
```python
# messages.py ç¬¬ 61 è¡Œ
'unread_count': 0  # ç¡¬ç¼–ç ä¸º 0ï¼

# messages.py ç¬¬ 180 è¡Œ
encrypted_content = base64.b64encode(content.encode()).decode()
# è¿™ä¸æ˜¯åŠ å¯†ï¼Œåªæ˜¯ç¼–ç ï¼
```

**ç¼ºå¤±åŠŸèƒ½**ï¼š
- âŒ çœŸæ­£çš„ç«¯åˆ°ç«¯åŠ å¯†
- âŒ æ¶ˆæ¯å·²è¯»çŠ¶æ€æ›´æ–°
- âŒ æ¶ˆæ¯åˆ é™¤/æ’¤å›
- âŒ æ¶ˆæ¯ç¼–è¾‘
- âŒ æ¶ˆæ¯æœç´¢
- âŒ æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½
- âŒ å›¾ç‰‡/è§†é¢‘æ¶ˆæ¯
- âŒ è¯­éŸ³æ¶ˆæ¯
- âŒ æ¶ˆæ¯è½¬å‘
- âŒ æ¶ˆæ¯å¼•ç”¨/å›å¤
- âŒ ç¾¤ç»„æ¶ˆæ¯
- âŒ æ¶ˆæ¯åˆ†é¡µï¼ˆè™½ç„¶æœ‰å‚æ•°ä½†æœªå®ç°ï¼‰

**å…¶ä»–è·¯ç”±**ï¼š
- `/api/projects` - é¡¹ç›®ç®¡ç†ï¼ˆå·²å®ç°ï¼‰
- `/api/groups` - ç¾¤ç»„åŠŸèƒ½ï¼ˆå¯é€‰å¯¼å…¥ï¼Œå¯èƒ½æœªå®Œå…¨å®ç°ï¼‰
- `/api/notifications` - é€šçŸ¥åŠŸèƒ½ï¼ˆå¯é€‰å¯¼å…¥ï¼‰
- `/api/linkedin` - LinkedIn OAuthï¼ˆå·²å®ç°ï¼‰

### 2.4 å®æ—¶é€šä¿¡åˆ†æ

**Socket.IO å®ç°çŠ¶æ€**ï¼š

åç«¯å­˜åœ¨å®Œæ•´çš„ Socket.IO å®ç°æ–‡ä»¶ï¼š
- `socket_app.py` - Socket.IO åº”ç”¨å…¥å£
- `socket_app_enhanced.py` - å¢å¼ºç‰ˆæœ¬
- `socket_server.py` - æœåŠ¡å™¨é€»è¾‘
- `deploy/socket_io_config.py` - éƒ¨ç½²é…ç½®
- `deploy/nginx_socket_io.conf` - Nginx é…ç½®

**éƒ¨ç½²çŠ¶æ€æœªçŸ¥**ï¼š
- âš ï¸ ä»£ç å­˜åœ¨ä½†æœªç¡®è®¤æ˜¯å¦åœ¨ç”Ÿäº§ç¯å¢ƒè¿è¡Œ
- âš ï¸ ä¸»åº”ç”¨ (main.py) è¿è¡Œåœ¨ Flaskï¼ŒSocket.IO éœ€è¦å•ç‹¬è¿›ç¨‹
- âš ï¸ å‰ç«¯æ˜¯å¦æ­£ç¡®è¿æ¥åˆ° Socket.IO æœåŠ¡å™¨æœªéªŒè¯

**å¦‚æœæœªéƒ¨ç½²ï¼Œå½±å“**ï¼š
- âŒ æ— å®æ—¶æ¶ˆæ¯æ¨é€
- âŒ æ— åœ¨çº¿çŠ¶æ€æ˜¾ç¤º
- âŒ æ— "æ­£åœ¨è¾“å…¥"æç¤º
- âŒ ç”¨æˆ·éœ€è¦æ‰‹åŠ¨åˆ·æ–°æ‰èƒ½çœ‹åˆ°æ–°æ¶ˆæ¯

### 2.5 æ™ºèƒ½åˆçº¦åˆ†æ

**å·²å£°ç§°éƒ¨ç½²çš„åˆçº¦** (æ ¹æ® README)ï¼š

| åˆçº¦åç§° | ç½‘ç»œ | åœ°å€ | çŠ¶æ€ |
|---------|------|------|------|
| UserIdentity | Sepolia | 0x5FbDB2315678afecb367f032d93F642f64180aa3 | âš ï¸ ç–‘ä¼¼æœ¬åœ°æµ‹è¯•åœ°å€ |
| MessageStorage | Sepolia | 0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512 | âš ï¸ ç–‘ä¼¼æœ¬åœ°æµ‹è¯•åœ°å€ |
| PaymentEscrow | Sepolia | 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0 | âš ï¸ ç–‘ä¼¼æœ¬åœ°æµ‹è¯•åœ°å€ |
| ProjectCollaboration | Sepolia | 0xCf7Ed3AccA5a467e9e704C703E8D87F634fB0Fc9 | âš ï¸ ç–‘ä¼¼æœ¬åœ°æµ‹è¯•åœ°å€ |

**ä¸¥é‡é—®é¢˜**ï¼š
è¿™äº›åœ°å€çœ‹èµ·æ¥åƒ Hardhat æœ¬åœ°æµ‹è¯•ç½‘ç»œçš„é»˜è®¤éƒ¨ç½²åœ°å€ï¼ˆ0x5FbDB...ã€0xe7f17...ï¼‰ï¼Œè€Œä¸æ˜¯çœŸå®çš„ Sepolia æµ‹è¯•ç½‘åœ°å€ã€‚çœŸå®çš„ Sepolia åœ°å€åº”è¯¥æ˜¯éšæœºçš„ã€‚

**å¦‚æœåˆçº¦æœªçœŸå®éƒ¨ç½²**ï¼š
- âŒ æ‰€æœ‰åŒºå—é“¾åŠŸèƒ½å®Œå…¨æ— æ³•ä½¿ç”¨
- âŒ æ¶ˆæ¯æ— æ³•å­˜å‚¨åˆ°åŒºå—é“¾
- âŒ æ”¯ä»˜åŠŸèƒ½æ— æ³•ä½¿ç”¨
- âŒ é¡¹ç›®åä½œåŠŸèƒ½æ— æ³•ä½¿ç”¨
- âŒ ç”¨æˆ·èº«ä»½éªŒè¯æ— æ³•ä½¿ç”¨

è¿™ä¸ `GAPS_AND_ISSUES.md` ä¸­çš„ç¬¬ä¸€ä¸ªä¸¥é‡é—®é¢˜ä¸€è‡´ã€‚

---

## ä¸‰ã€ç”Ÿäº§çº§æ ‡å‡†å¯¹æ¯”åˆ†æ

### 3.1 ä¸ Telegram åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ç±»åˆ« | Telegram | Dchat å½“å‰çŠ¶æ€ | å·®è·è¯„ä¼° |
|---------|----------|---------------|---------|
| **åŸºç¡€æ¶ˆæ¯** | âœ… æ–‡æœ¬/è¡¨æƒ…/è´´çº¸ | âš ï¸ ä»…æ–‡æœ¬ | å·¨å¤§å·®è· |
| **å¯Œåª’ä½“** | âœ… å›¾ç‰‡/è§†é¢‘/æ–‡ä»¶/è¯­éŸ³ | âŒ å®Œå…¨ç¼ºå¤± | è‡´å‘½ç¼ºé™· |
| **ç¾¤ç»„** | âœ… æœ€å¤š20ä¸‡äºº | âŒ æœªå®ç° | è‡´å‘½ç¼ºé™· |
| **é¢‘é“** | âœ… æ— é™è®¢é˜…è€… | âŒ æœªå®ç° | è‡´å‘½ç¼ºé™· |
| **å®æ—¶æ€§** | âœ… æ¯«ç§’çº§æ¨é€ | âŒ éœ€æ‰‹åŠ¨åˆ·æ–° | è‡´å‘½ç¼ºé™· |
| **åŠ å¯†** | âœ… MTProto | âŒ Base64ä¼ªè£… | è‡´å‘½å®‰å…¨æ¼æ´ |
| **æœç´¢** | âœ… å…¨å±€æœç´¢ | âŒ æœªå®ç° | é‡å¤§ç¼ºé™· |
| **è¯­éŸ³/è§†é¢‘é€šè¯** | âœ… æ”¯æŒ | âŒ æœªå®ç° | é‡å¤§ç¼ºé™· |
| **æœºå™¨äºº** | âœ… Bot API | âŒ æœªå®ç° | é‡å¤§ç¼ºé™· |
| **å¤šè®¾å¤‡åŒæ­¥** | âœ… äº‘åŒæ­¥ | âŒ æœªå®ç° | é‡å¤§ç¼ºé™· |
| **ç¦»çº¿æ¶ˆæ¯** | âœ… å®Œæ•´æ”¯æŒ | âš ï¸ ä¾èµ–åŒºå—é“¾ | ä¸­ç­‰å·®è· |
| **å·²è¯»å›æ‰§** | âœ… åŒå‹¾æ ‡è®° | âŒ æœªå®ç° | ä¸­ç­‰å·®è· |

**ç»“è®º**: Dchat å½“å‰åŠŸèƒ½å®Œæˆåº¦ä¸è¶³ Telegram çš„ 20%ï¼Œæ— æ³•ä½œä¸ºç”Ÿäº§çº§èŠå¤©å·¥å…·ä½¿ç”¨ã€‚

### 3.2 æ ¸å¿ƒåŠŸèƒ½ç¼ºå¤±æ¸…å•

**P0 çº§åˆ«ï¼ˆè‡´å‘½ç¼ºé™·ï¼Œå¿…é¡»ç«‹å³ä¿®å¤ï¼‰**ï¼š

1. **æ™ºèƒ½åˆçº¦æœªçœŸå®éƒ¨ç½²** - æ‰€æœ‰åŒºå—é“¾åŠŸèƒ½æ— æ³•ä½¿ç”¨
2. **ç­¾åéªŒè¯ç¼ºå¤±** - ä»»ä½•äººå¯ä»¥ä¼ªé€ èº«ä»½ç™»å½•
3. **åŠ å¯†åŠŸèƒ½æœªå®ç°** - æ¶ˆæ¯ä»¥æ˜æ–‡å­˜å‚¨ï¼Œä¸¥é‡å®‰å…¨æ¼æ´
4. **å®æ—¶æ¶ˆæ¯æ¨é€ç¼ºå¤±** - ä¸æ˜¯çœŸæ­£çš„"èŠå¤©"åº”ç”¨
5. **æ–‡ä»¶ä¼ è¾“å®Œå…¨ç¼ºå¤±** - æ— æ³•å‘é€å›¾ç‰‡/æ–‡ä»¶ï¼ŒåŠŸèƒ½ä¸¥é‡ä¸å®Œæ•´

**P1 çº§åˆ«ï¼ˆä¸¥é‡ç¼ºé™·ï¼ŒçŸ­æœŸå†…å¿…é¡»ä¿®å¤ï¼‰**ï¼š

6. **ç¾¤ç»„èŠå¤©æœªå®ç°** - å•†ä¸šé€šä¿¡çš„æ ¸å¿ƒéœ€æ±‚
7. **æ¶ˆæ¯å·²è¯»çŠ¶æ€ä¸å·¥ä½œ** - ç”¨æˆ·ä½“éªŒå·®
8. **ç”¨æˆ·èµ„æ–™ä¸å®Œæ•´** - åªæœ‰é’±åŒ…åœ°å€ï¼Œæ— æ³•è¯†åˆ«ç”¨æˆ·
9. **æ¶ˆæ¯æœç´¢ç¼ºå¤±** - æ— æ³•æŸ¥æ‰¾å†å²æ¶ˆæ¯
10. **IPFS æœªé›†æˆ** - æ— æ³•å­˜å‚¨å¤§æ–‡ä»¶

**P2 çº§åˆ«ï¼ˆé‡è¦ç¼ºé™·ï¼Œä¸­æœŸè®¡åˆ’ï¼‰**ï¼š

11. è¯­éŸ³/è§†é¢‘é€šè¯
12. æ¶ˆæ¯è½¬å‘å’Œå¼•ç”¨
13. åœ¨çº¿çŠ¶æ€æ˜¾ç¤º
14. å¤šè®¾å¤‡åŒæ­¥
15. æ¶ˆæ¯é€šçŸ¥

### 3.3 åç«¯è–„å¼±ç‚¹è¯¦ç»†åˆ†æ

**æ¶æ„å±‚é¢**ï¼š

1. **å•ä½“æ¶æ„** - Flask å•è¿›ç¨‹ï¼Œæ— æ³•æ°´å¹³æ‰©å±•
2. **æ— ç¼“å­˜å±‚** - æ¯æ¬¡éƒ½æŸ¥è¯¢æ•°æ®åº“/åŒºå—é“¾ï¼Œæ€§èƒ½å·®
3. **æ— æ¶ˆæ¯é˜Ÿåˆ—** - æ— æ³•å¤„ç†å¼‚æ­¥ä»»åŠ¡
4. **æ— æœåŠ¡æ‹†åˆ†** - è®¤è¯ã€æ¶ˆæ¯ã€æ”¯ä»˜è€¦åˆåœ¨ä¸€èµ·
5. **æ—  API ç½‘å…³** - ç¼ºå°‘ç»Ÿä¸€çš„å…¥å£å’Œé™æµ

**æ•°æ®åº“å±‚é¢**ï¼š

1. **æ— æ•°æ®åº“è¿ç§»å·¥å…·** - ä½¿ç”¨ `db.create_all()`ï¼Œæ— æ³•ç®¡ç† schema å˜æ›´
2. **æ— ç´¢å¼•ä¼˜åŒ–** - æ¶ˆæ¯æŸ¥è¯¢ä¼šéšç€æ•°æ®å¢é•¿å˜æ…¢
3. **æ— åˆ†åº“åˆ†è¡¨** - å•è¡¨å­˜å‚¨æ‰€æœ‰æ¶ˆæ¯ï¼Œæ— æ³•æ”¯æ’‘å¤§è§„æ¨¡ç”¨æˆ·
4. **æ— è¯»å†™åˆ†ç¦»** - è¯»å†™å‹åŠ›éƒ½åœ¨ä¸»åº“
5. **æ— å¤‡ä»½ç­–ç•¥** - æ•°æ®ä¸¢å¤±é£é™©

**å®‰å…¨å±‚é¢**ï¼š

1. **ç­¾åéªŒè¯ç¼ºå¤±** - è‡´å‘½å®‰å…¨æ¼æ´
2. **åŠ å¯†æœªå®ç°** - æ˜æ–‡å­˜å‚¨æ¶ˆæ¯
3. **æ—  HTTPS å¼ºåˆ¶** - å¯èƒ½è¢«ä¸­é—´äººæ”»å‡»
4. **æ—  SQL æ³¨å…¥é˜²æŠ¤** - ä½¿ç”¨ ORM ä½†æœªéªŒè¯æ‰€æœ‰è¾“å…¥
5. **æ—  XSS é˜²æŠ¤** - æ¶ˆæ¯å†…å®¹æœªè¿‡æ»¤
6. **æ—  CSRF é˜²æŠ¤** - API æœªå®ç° CSRF token
7. **æ— é™æµæœºåˆ¶** - å®¹æ˜“è¢« DDoS æ”»å‡»
8. **JWT æ— åˆ·æ–°æœºåˆ¶** - token æ³„éœ²å 30 å¤©å†…æœ‰æ•ˆ
9. **æ— å®¡è®¡æ—¥å¿—** - æ— æ³•è¿½è¸ªå®‰å…¨äº‹ä»¶
10. **ç¯å¢ƒå˜é‡ç®¡ç†æ··ä¹±** - æ•æ„Ÿä¿¡æ¯å¯èƒ½æ³„éœ²

**æ€§èƒ½å±‚é¢**ï¼š

1. **æ— è¿æ¥æ± ** - æ•°æ®åº“è¿æ¥æ•ˆç‡ä½
2. **æ— æŸ¥è¯¢ä¼˜åŒ–** - N+1 æŸ¥è¯¢é—®é¢˜
3. **æ—  CDN** - é™æ€èµ„æºåŠ è½½æ…¢
4. **æ— å›¾ç‰‡å‹ç¼©** - å¦‚æœå®ç°æ–‡ä»¶ä¼ è¾“ï¼Œä¼šæ¶ˆè€—å¤§é‡å¸¦å®½
5. **æ— æ‡’åŠ è½½** - ä¸€æ¬¡åŠ è½½æ‰€æœ‰æ¶ˆæ¯

**å¯é æ€§å±‚é¢**ï¼š

1. **æ— é”™è¯¯ç›‘æ§** - ç”Ÿäº§ç¯å¢ƒé”™è¯¯æ— æ³•è¿½è¸ª
2. **æ— å¥åº·æ£€æŸ¥** - è™½ç„¶æœ‰ `/api/health` ä½†åŠŸèƒ½ç®€å•
3. **æ— ç†”æ–­æœºåˆ¶** - ä¾èµ–æœåŠ¡æ•…éšœä¼šå¯¼è‡´é›ªå´©
4. **æ— é‡è¯•æœºåˆ¶** - åŒºå—é“¾äº¤æ˜“å¤±è´¥åä¸ä¼šé‡è¯•
5. **æ— æ—¥å¿—èšåˆ** - æ— æ³•åˆ†æé—®é¢˜

**æµ‹è¯•å±‚é¢**ï¼š

1. **æµ‹è¯•è¦†ç›–ç‡æä½** - åªæœ‰å°‘é‡æµ‹è¯•æ–‡ä»¶
2. **æ— é›†æˆæµ‹è¯•** - ç«¯åˆ°ç«¯åŠŸèƒ½æœªéªŒè¯
3. **æ— æ€§èƒ½æµ‹è¯•** - ä¸çŸ¥é“ç³»ç»Ÿèƒ½æ”¯æ’‘å¤šå°‘ç”¨æˆ·
4. **æ— å®‰å…¨æµ‹è¯•** - æ¼æ´æœªè¢«å‘ç°

---

## å››ã€ä¸ç«å“å¯¹æ¯”çš„è‡´å‘½å·®è·

### 4.1 æŠ€æœ¯æ¶æ„å·®è·

**Telegram æ¶æ„** (å…¬å¼€ä¿¡æ¯):
- åˆ†å¸ƒå¼æ¶æ„ï¼Œå…¨çƒå¤šä¸ªæ•°æ®ä¸­å¿ƒ
- MTProto è‡ªç ”åŠ å¯†åè®®
- å¤šå±‚ç¼“å­˜ç³»ç»Ÿ
- æ¶ˆæ¯é˜Ÿåˆ—å¤„ç†å¼‚æ­¥ä»»åŠ¡
- å¾®æœåŠ¡æ¶æ„

**Dchat å½“å‰æ¶æ„**:
- å•ä½“ Flask åº”ç”¨
- æ— åŠ å¯†ï¼ˆä¼ªè£…æˆ base64ï¼‰
- æ— ç¼“å­˜
- æ— æ¶ˆæ¯é˜Ÿåˆ—
- å•ä½“æ¶æ„

**å·®è·**: 10 å¹´ä»¥ä¸Šçš„æŠ€æœ¯ä»£å·®

### 4.2 åŠŸèƒ½å®Œæ•´åº¦å·®è·

**ç”Ÿäº§çº§èŠå¤©åº”ç”¨å¿…å¤‡åŠŸèƒ½**:

| åŠŸèƒ½ | Telegram | WhatsApp | Signal | Dchat | å®Œæˆåº¦ |
|-----|----------|----------|--------|-------|--------|
| æ–‡æœ¬æ¶ˆæ¯ | âœ… | âœ… | âœ… | âš ï¸ | 30% |
| å›¾ç‰‡/è§†é¢‘ | âœ… | âœ… | âœ… | âŒ | 0% |
| æ–‡ä»¶ä¼ è¾“ | âœ… | âœ… | âœ… | âŒ | 0% |
| è¯­éŸ³æ¶ˆæ¯ | âœ… | âœ… | âœ… | âŒ | 0% |
| è¯­éŸ³é€šè¯ | âœ… | âœ… | âœ… | âŒ | 0% |
| è§†é¢‘é€šè¯ | âœ… | âœ… | âœ… | âŒ | 0% |
| ç¾¤ç»„èŠå¤© | âœ… | âœ… | âœ… | âŒ | 0% |
| ç«¯åˆ°ç«¯åŠ å¯† | âœ… | âœ… | âœ… | âŒ | 0% |
| å®æ—¶æ¨é€ | âœ… | âœ… | âœ… | âŒ | 0% |
| æ¶ˆæ¯æœç´¢ | âœ… | âœ… | âœ… | âŒ | 0% |
| å·²è¯»å›æ‰§ | âœ… | âœ… | âœ… | âŒ | 0% |
| åœ¨çº¿çŠ¶æ€ | âœ… | âœ… | âœ… | âŒ | 0% |
| å¤šè®¾å¤‡åŒæ­¥ | âœ… | âœ… | âœ… | âŒ | 0% |
| æ¶ˆæ¯å¤‡ä»½ | âœ… | âœ… | âœ… | âŒ | 0% |

**å¹³å‡å®Œæˆåº¦**: çº¦ 2%

### 4.3 ç”¨æˆ·ä½“éªŒå·®è·

**å…³é”®æŒ‡æ ‡å¯¹æ¯”**:

| æŒ‡æ ‡ | Telegram | Dchat é¢„ä¼° | å·®è· |
|-----|----------|-----------|------|
| æ¶ˆæ¯å‘é€å»¶è¿Ÿ | <100ms | >3s (åŒºå—é“¾ç¡®è®¤) | 30å€ |
| ç™»å½•æ—¶é—´ | <2s | >10s (MetaMask äº¤äº’) | 5å€ |
| é¦–å±åŠ è½½ | <1s | >5s (åŒºå—é“¾æŸ¥è¯¢) | 5å€ |
| ç¦»çº¿æ¶ˆæ¯æ¥æ”¶ | å³æ—¶ | éœ€æ‰‹åŠ¨åˆ·æ–° | æ— ç©·å¤§ |
| æ–‡ä»¶ä¼ è¾“é€Ÿåº¦ | é«˜é€Ÿ | ä¸æ”¯æŒ | æ— ç©·å¤§ |

---

## äº”ã€ç”Ÿäº§ç¯å¢ƒé£é™©è¯„ä¼°

### 5.1 å®‰å…¨é£é™©ï¼ˆæé«˜ï¼‰

1. **èº«ä»½ä¼ªé€ é£é™©**: ä»»ä½•äººå¯ä»¥ä¼ªé€ é’±åŒ…åœ°å€ç™»å½•ï¼Œçªƒå–ä»–äººè´¦æˆ·
2. **æ¶ˆæ¯æ³„éœ²é£é™©**: æ˜æ–‡å­˜å‚¨æ¶ˆæ¯ï¼Œæ•°æ®åº“æ³„éœ²å³å…¨éƒ¨æ³„éœ²
3. **ä¸­é—´äººæ”»å‡»**: æ— çœŸå®åŠ å¯†ï¼Œä¼ è¾“è¿‡ç¨‹å¯è¢«çªƒå¬
4. **DDoS æ”»å‡»**: æ— é™æµæœºåˆ¶ï¼Œå®¹æ˜“è¢«æ”»å‡»ç˜«ç—ª
5. **SQL æ³¨å…¥**: è¾“å…¥éªŒè¯ä¸å®Œæ•´
6. **XSS æ”»å‡»**: æ¶ˆæ¯å†…å®¹æœªè¿‡æ»¤

**é£é™©ç­‰çº§**: ğŸ”´ æé«˜ - ä¸é€‚åˆå¤„ç†ä»»ä½•æ•æ„Ÿä¿¡æ¯

### 5.2 å¯ç”¨æ€§é£é™©ï¼ˆé«˜ï¼‰

1. **æ™ºèƒ½åˆçº¦æœªéƒ¨ç½²**: æ ¸å¿ƒåŠŸèƒ½å®Œå…¨æ— æ³•ä½¿ç”¨
2. **å•ç‚¹æ•…éšœ**: Flask å•è¿›ç¨‹ï¼Œå´©æºƒå³å…¨ç«™ä¸å¯ç”¨
3. **æ€§èƒ½ç“¶é¢ˆ**: æ— ç¼“å­˜ï¼Œç”¨æˆ·å¢é•¿ä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒ
4. **æ•°æ®ä¸¢å¤±**: æ— å¤‡ä»½ç­–ç•¥ï¼Œæ•°æ®åº“æ•…éšœå³æ°¸ä¹…ä¸¢å¤±
5. **åŒºå—é“¾ä¾èµ–**: Gas è´¹ç”¨é«˜å³°æœŸæ— æ³•å‘é€æ¶ˆæ¯

**é£é™©ç­‰çº§**: ğŸ”´ é«˜ - æ— æ³•ä¿è¯æœåŠ¡å¯ç”¨æ€§

### 5.3 åˆè§„é£é™©ï¼ˆé«˜ï¼‰

1. **GDPR åˆè§„**: åŒºå—é“¾å­˜å‚¨æ— æ³•åˆ é™¤ï¼Œè¿å"è¢«é—å¿˜æƒ"
2. **æ•°æ®ä¸»æƒ**: æ¶ˆæ¯å­˜å‚¨åœ¨å…¬é“¾ï¼Œæ— æ³•æ»¡è¶³æ•°æ®æœ¬åœ°åŒ–è¦æ±‚
3. **åŠ å¯†åˆè§„**: å£°ç§°åŠ å¯†ä½†æœªå®ç°ï¼Œè™šå‡å®£ä¼ 
4. **éšç§ä¿æŠ¤**: é’±åŒ…åœ°å€å…¬å¼€ï¼Œå¯è¿½è¸ªç”¨æˆ·è¡Œä¸º

**é£é™©ç­‰çº§**: ğŸŸ¡ ä¸­é«˜ - å¯èƒ½é¢ä¸´æ³•å¾‹è¯‰è®¼

---

## å…­ã€æ ¸å¿ƒé—®é¢˜æ€»ç»“

### 6.1 å‰ç«¯é—®é¢˜

**å·²å®Œå–„**:
- âœ… ç™»å½•ç•Œé¢è®¾è®¡ä¸“ä¸š
- âœ… ä¸‰ç§ç™»å½•æ–¹å¼ UI å®Œæ•´
- âœ… å“åº”å¼è®¾è®¡è‰¯å¥½
- âœ… è¥é”€é¡µé¢è®¾è®¡åˆæ ¼

**ä¸å®Œå–„**:
- âš ï¸ ç™»å½•åŠŸèƒ½æœªå®é™…æµ‹è¯•
- âš ï¸ èŠå¤©ç•Œé¢åŠŸèƒ½æœªæµ‹è¯•ï¼ˆéœ€ç™»å½•ï¼‰
- âš ï¸ æ–‡ä»¶ä¸Šä¼ æŒ‰é’®ç¦ç”¨
- âš ï¸ å›¾ç‰‡/è§†é¢‘æ¶ˆæ¯ä¸æ”¯æŒ

**æœªå®Œæˆ**:
- âŒ ç¾¤ç»„èŠå¤©ç•Œé¢
- âŒ è¯­éŸ³/è§†é¢‘é€šè¯ç•Œé¢
- âŒ æ¶ˆæ¯æœç´¢ç•Œé¢
- âŒ ç”¨æˆ·èµ„æ–™å®Œæ•´ç•Œé¢

### 6.2 åç«¯æ ¸å¿ƒé—®é¢˜

**è‡´å‘½ç¼ºé™·**:
1. âŒ **ç­¾åéªŒè¯ç¼ºå¤±** - ä»»ä½•äººå¯ä¼ªé€ èº«ä»½
2. âŒ **åŠ å¯†æœªå®ç°** - åªæœ‰ base64 ç¼–ç 
3. âŒ **æ™ºèƒ½åˆçº¦ç–‘ä¼¼æœªéƒ¨ç½²** - åœ°å€åƒæµ‹è¯•ç½‘
4. âŒ **å®æ—¶æ¨é€æœªç¡®è®¤éƒ¨ç½²** - Socket.IO ä»£ç å­˜åœ¨ä½†å¯èƒ½æœªè¿è¡Œ
5. âŒ **æ–‡ä»¶ä¼ è¾“å®Œå…¨ç¼ºå¤±** - IPFS æœªé›†æˆ

**ä¸¥é‡è–„å¼±ç‚¹**:
1. âš ï¸ **æ— æ•°æ®åº“è¿ç§»** - æ— æ³•ç®¡ç† schema å˜æ›´
2. âš ï¸ **æ— ç¼“å­˜å±‚** - æ€§èƒ½å·®
3. âš ï¸ **æ— é™æµæœºåˆ¶** - æ˜“è¢«æ”»å‡»
4. âš ï¸ **æ— é”™è¯¯ç›‘æ§** - é—®é¢˜æ— æ³•è¿½è¸ª
5. âš ï¸ **æµ‹è¯•è¦†ç›–ç‡ä½** - è´¨é‡æ— ä¿è¯
6. âš ï¸ **å•ä½“æ¶æ„** - æ— æ³•æ‰©å±•
7. âš ï¸ **æ¶ˆæ¯å·²è¯»çŠ¶æ€ç¡¬ç¼–ç ä¸º 0** - åŠŸèƒ½æœªå®ç°
8. âš ï¸ **JWT æ— åˆ·æ–°æœºåˆ¶** - å®‰å…¨é£é™©
9. âš ï¸ **æ— å¤‡ä»½ç­–ç•¥** - æ•°æ®ä¸¢å¤±é£é™©
10. âš ï¸ **ç¯å¢ƒå˜é‡ç®¡ç†æ··ä¹±** - é…ç½®é£é™©

**åŠŸèƒ½ç¼ºå¤±**:
1. âŒ ç¾¤ç»„æ¶ˆæ¯åç«¯é€»è¾‘
2. âŒ æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½ API
3. âŒ æ¶ˆæ¯æœç´¢ API
4. âŒ æ¶ˆæ¯åˆ é™¤/ç¼–è¾‘ API
5. âŒ ç”¨æˆ·åœ¨çº¿çŠ¶æ€ç®¡ç†
6. âŒ æ¶ˆæ¯é€šçŸ¥ç³»ç»Ÿ
7. âŒ å¤šè®¾å¤‡åŒæ­¥
8. âŒ æ¶ˆæ¯å¤‡ä»½/å¯¼å‡º

---

## ä¸ƒã€ä¸ç«å“çš„å·®è·è¯„ä¼°

### 7.1 åŠŸèƒ½å·®è·

**ä¸ Telegram å¯¹æ¯”**:
- åŠŸèƒ½å®Œæˆåº¦: 2%
- æŠ€æœ¯æˆç†Ÿåº¦: 10 å¹´ä»£å·®
- ç”¨æˆ·ä½“éªŒ: 30 å€å»¶è¿Ÿå·®è·
- å®‰å…¨æ€§: å­˜åœ¨è‡´å‘½æ¼æ´

**ä¸ Signal å¯¹æ¯”**:
- åŠ å¯†: Signal æœ‰çœŸå®çš„ç«¯åˆ°ç«¯åŠ å¯†ï¼ŒDchat åªæœ‰ base64
- éšç§: Signal æœ€å°åŒ–å…ƒæ•°æ®ï¼ŒDchat åœ¨å…¬é“¾ä¸Šå…¬å¼€
- æ€§èƒ½: Signal ä¼˜åŒ–æè‡´ï¼ŒDchat ä¾èµ–åŒºå—é“¾ç¡®è®¤

**ä¸ WhatsApp å¯¹æ¯”**:
- ç”¨æˆ·è§„æ¨¡: WhatsApp æ”¯æŒ 20 äº¿ç”¨æˆ·ï¼ŒDchat å•ä½“æ¶æ„æ— æ³•æ‰©å±•
- åŠŸèƒ½å®Œæ•´: WhatsApp åŠŸèƒ½é½å…¨ï¼ŒDchat åŸºç¡€åŠŸèƒ½ç¼ºå¤±
- å¯é æ€§: WhatsApp 99.9% å¯ç”¨æ€§ï¼ŒDchat å­˜åœ¨å•ç‚¹æ•…éšœ

### 7.2 æŠ€æœ¯å€ºåŠ¡

**ä¼°ç®—ä¿®å¤æ—¶é—´**:
- P0 é—®é¢˜ä¿®å¤: 2-3 ä¸ªæœˆï¼ˆå…¨èŒå›¢é˜Ÿï¼‰
- P1 é—®é¢˜ä¿®å¤: 3-6 ä¸ªæœˆ
- è¾¾åˆ° Telegram 20% åŠŸèƒ½: 12-18 ä¸ªæœˆ
- è¾¾åˆ°ç”Ÿäº§çº§æ ‡å‡†: 24-36 ä¸ªæœˆ

**ä¼°ç®—æˆæœ¬**:
- åç«¯é‡æ„: $200,000 - $500,000
- å®‰å…¨åŠ å›º: $100,000 - $200,000
- åŠŸèƒ½è¡¥å…¨: $500,000 - $1,000,000
- æµ‹è¯•å’Œä¼˜åŒ–: $100,000 - $300,000
- **æ€»è®¡**: $900,000 - $2,000,000

---

## å…«ã€å»ºè®®å’Œç»“è®º

### 8.1 ç«‹å³è¡ŒåŠ¨é¡¹ï¼ˆP0ï¼‰

1. **åœæ­¢å®£ä¼ åŠ å¯†åŠŸèƒ½** - å½“å‰å®ç°æ˜¯è™šå‡å®£ä¼ ï¼Œå­˜åœ¨æ³•å¾‹é£é™©
2. **ä¿®å¤ç­¾åéªŒè¯** - å®ç°çœŸæ­£çš„ Web3 ç­¾åéªŒè¯
3. **éªŒè¯æ™ºèƒ½åˆçº¦éƒ¨ç½²** - ç¡®è®¤åˆçº¦æ˜¯å¦çœŸå®éƒ¨ç½²åˆ° Sepolia
4. **å®ç°çœŸæ­£çš„åŠ å¯†** - é›†æˆ RSA æˆ– ECDH ç«¯åˆ°ç«¯åŠ å¯†
5. **éƒ¨ç½²å®æ—¶æ¨é€** - ç¡®ä¿ Socket.IO åœ¨ç”Ÿäº§ç¯å¢ƒè¿è¡Œ

### 8.2 çŸ­æœŸä¼˜åŒ–ï¼ˆP1ï¼‰

1. é›†æˆ IPFS å®ç°æ–‡ä»¶ä¼ è¾“
2. å®ç°æ¶ˆæ¯å·²è¯»çŠ¶æ€
3. å®Œå–„ç”¨æˆ·èµ„æ–™ç³»ç»Ÿ
4. å®ç°ç¾¤ç»„èŠå¤©
5. æ·»åŠ é”™è¯¯ç›‘æ§ï¼ˆSentryï¼‰
6. å®ç°æ•°æ®åº“è¿ç§»å·¥å…·ï¼ˆAlembicï¼‰
7. æ·»åŠ  Redis ç¼“å­˜å±‚
8. å®ç° API é™æµ

### 8.3 ä¸­æœŸè§„åˆ’ï¼ˆP2ï¼‰

1. æ¶æ„é‡æ„ä¸ºå¾®æœåŠ¡
2. å®ç°è¯­éŸ³/è§†é¢‘é€šè¯
3. æ·»åŠ æ¶ˆæ¯æœç´¢
4. å®ç°å¤šè®¾å¤‡åŒæ­¥
5. æ€§èƒ½ä¼˜åŒ–å’Œå‹åŠ›æµ‹è¯•
6. å®‰å…¨å®¡è®¡å’Œæ¸—é€æµ‹è¯•
7. å®Œå–„æµ‹è¯•è¦†ç›–ç‡
8. å®ç° CI/CD æµæ°´çº¿

### 8.4 æœ€ç»ˆç»“è®º

**å½“å‰çŠ¶æ€**: Dchat æ˜¯ä¸€ä¸ª**æ—©æœŸåŸå‹**ï¼Œè€Œä¸æ˜¯ç”Ÿäº§çº§åº”ç”¨ã€‚

**æ ¸å¿ƒé—®é¢˜**:
1. å®‰å…¨æ€§å­˜åœ¨è‡´å‘½æ¼æ´ï¼ˆç­¾åéªŒè¯ç¼ºå¤±ã€åŠ å¯†æœªå®ç°ï¼‰
2. åŠŸèƒ½å®Œæ•´åº¦ä¸è¶³ 5%ï¼ˆå¯¹æ¯” Telegramï¼‰
3. åç«¯æ¶æ„æ— æ³•æ”¯æ’‘å•†ä¸šåŒ–è¿è¥
4. æ™ºèƒ½åˆçº¦éƒ¨ç½²çŠ¶æ€å­˜ç–‘

**ç«äº‰åŠ›è¯„ä¼°**:
- ä¸ Telegram ç«äº‰: âŒ ä¸å¯èƒ½ï¼ˆå·®è· 10 å¹´ä»¥ä¸Šï¼‰
- ä¸ Signal ç«äº‰: âŒ ä¸å¯èƒ½ï¼ˆå®‰å…¨æ€§å·®è·å·¨å¤§ï¼‰
- ä¸ WhatsApp ç«äº‰: âŒ ä¸å¯èƒ½ï¼ˆåŠŸèƒ½å’Œè§„æ¨¡å·®è·å·¨å¤§ï¼‰

**å»ºè®®**:
1. **é‡æ–°å®šä½**: ä¸è¦å£°ç§°ä¸ Telegram ç«äº‰ï¼Œè€Œæ˜¯å®šä½ä¸º"Web3 ç¤¾äº¤å®éªŒ"æˆ–"å»ä¸­å¿ƒåŒ–é€šä¿¡åŸå‹"
2. **ä¿®å¤å®‰å…¨æ¼æ´**: ç«‹å³ä¿®å¤ç­¾åéªŒè¯å’ŒåŠ å¯†é—®é¢˜
3. **å®Œå–„åŸºç¡€åŠŸèƒ½**: å…ˆå®ç°æ–‡ä»¶ä¼ è¾“ã€ç¾¤ç»„èŠå¤©ç­‰åŸºç¡€åŠŸèƒ½
4. **æ¶æ„é‡æ„**: è€ƒè™‘ä½¿ç”¨æˆç†Ÿçš„å¼€æºæ–¹æ¡ˆï¼ˆå¦‚ Matrix Protocolï¼‰
5. **ç°å®é¢„æœŸ**: è¾¾åˆ°ç”Ÿäº§çº§æ ‡å‡†éœ€è¦ 2-3 å¹´å’Œ $1-2M æŠ•èµ„

**é£é™©è­¦å‘Š**: 
åœ¨å½“å‰çŠ¶æ€ä¸‹ä¸Šçº¿å•†ä¸šè¿è¥ï¼Œå­˜åœ¨ä¸¥é‡çš„å®‰å…¨é£é™©ã€æ³•å¾‹é£é™©å’Œå£°èª‰é£é™©ã€‚å»ºè®®åœ¨ä¿®å¤ P0 çº§åˆ«é—®é¢˜ä¹‹å‰ï¼Œä¸è¦æ¥å…¥çœŸå®ç”¨æˆ·ã€‚

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-11-04  
**åˆ†ææ·±åº¦**: æ·±åº¦ä»£ç å®¡æŸ¥ + æ¶æ„åˆ†æ  
**å¯ä¿¡åº¦**: é«˜ï¼ˆåŸºäºå®é™…ä»£ç å’Œæ–‡æ¡£ï¼‰


---


# Dchat æŠ€æœ¯æ¶æ„å®Œå–„æ–¹æ¡ˆ

## ä¸€ã€ç°æœ‰ä»£ç èµ„äº§åˆ†æ

### 1.1 å‰ç«¯å·²æœ‰ä½†æœªä½¿ç”¨çš„æœåŠ¡

é€šè¿‡ä»£ç å®¡æŸ¥ï¼Œå‘ç°å‰ç«¯å·²ç»å®ç°äº†å¤§é‡æœåŠ¡ç±»ï¼Œä½†åç«¯æœªæä¾›å¯¹åº”æ”¯æŒæˆ–æœªæ­£ç¡®é›†æˆï¼š

**å·²å®ç°çš„å‰ç«¯æœåŠ¡**ï¼š
- âœ… `EncryptionService.js` - å®Œæ•´çš„ RSA + AES æ··åˆåŠ å¯†å®ç°
- âœ… `AdvancedEncryptionService.js` - é«˜çº§åŠ å¯†åŠŸèƒ½
- âœ… `MessageStorageService.js` - åŒºå—é“¾æ¶ˆæ¯å­˜å‚¨æœåŠ¡
- âœ… `GroupService.js` / `GroupMessageService.js` - ç¾¤ç»„èŠå¤©æœåŠ¡
- âœ… `IPFSService.js` - IPFS æ–‡ä»¶å­˜å‚¨æœåŠ¡
- âœ… `FileUploadService.js` / `EncryptedFileTransfer.js` - æ–‡ä»¶ä¸Šä¼ å’ŒåŠ å¯†ä¼ è¾“
- âœ… `PresenceService.js` - åœ¨çº¿çŠ¶æ€æœåŠ¡
- âœ… `PaymentService.js` / `PaymentEscrowService.js` - æ”¯ä»˜å’Œæ‰˜ç®¡æœåŠ¡
- âœ… `SubscriptionService.js` - è®¢é˜…æœåŠ¡
- âœ… `UserIdentityService.js` - ç”¨æˆ·èº«ä»½æœåŠ¡

**é—®é¢˜**ï¼šè¿™äº›å‰ç«¯æœåŠ¡å·²ç»ç¼–å†™å®Œæˆï¼Œä½†ï¼š
1. åç«¯ API ä¸å®Œæ•´æˆ–ç¼ºå¤±
2. æ™ºèƒ½åˆçº¦åœ°å€é…ç½®å¯èƒ½ä¸æ­£ç¡®
3. æœåŠ¡ä¹‹é—´çš„é›†æˆä¸å®Œæ•´

**ä¼˜å…ˆç­–ç•¥**ï¼šå…ˆè®©è¿™äº›å·²æœ‰ä»£ç å·¥ä½œèµ·æ¥ï¼Œè€Œä¸æ˜¯é‡æ–°å¼€å‘ã€‚

### 1.2 åç«¯å·²æœ‰ä½†æœªé›†æˆçš„åŠŸèƒ½

**å·²å®ç°çš„åç«¯åŠŸèƒ½**ï¼š
- âœ… `socket_app.py` / `socket_server.py` - Socket.IO å®æ—¶é€šä¿¡ï¼ˆæœªéƒ¨ç½²ï¼‰
- âœ… `payments.js` - Stripe æ”¯ä»˜é›†æˆï¼ˆæœªæµ‹è¯•ï¼‰
- âœ… `subscription.js` / `subscriptionController.js` - è®¢é˜…ç®¡ç†ï¼ˆæœªé›†æˆåˆ°ä¸»åº”ç”¨ï¼‰
- âœ… `linkedin_oauth_service.js` - LinkedIn OAuthï¼ˆå·²å®ç°ï¼‰

**é—®é¢˜**ï¼šè¿™äº›åŠŸèƒ½ä»£ç å­˜åœ¨ä½†æœªå¯ç”¨æˆ–æœªé›†æˆåˆ°ä¸»åº”ç”¨ã€‚

---

## äºŒã€P0 çº§è‡´å‘½ç¼ºé™·ä¿®å¤æ–¹æ¡ˆ

### 2.1 ç­¾åéªŒè¯ç¼ºå¤±

**å½“å‰é—®é¢˜**ï¼š
```python
# backend/src/routes/auth.py ç¬¬ 18 è¡Œ
signature = data.get('signature')  # è·å–ä½†ä»ä¸éªŒè¯ï¼
```

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨ Web3.py éªŒè¯ç­¾å

**å®ç°è®¡åˆ’**ï¼š
1. åœ¨åç«¯æ·»åŠ ç­¾åéªŒè¯é€»è¾‘
2. ç”Ÿæˆéšæœº nonce é˜²æ­¢é‡æ”¾æ”»å‡»
3. éªŒè¯ç­¾åæ¶ˆæ¯æ ¼å¼å’Œæ—¶é—´æˆ³

**ä»£ç ä½ç½®**ï¼š`backend/src/routes/auth.py`

---

### 2.2 åŠ å¯†åŠŸèƒ½æœªé›†æˆ

**å½“å‰é—®é¢˜**ï¼š
- å‰ç«¯æœ‰å®Œæ•´çš„ `EncryptionService.js`ï¼Œä½†æœªåœ¨èŠå¤©æµç¨‹ä¸­ä½¿ç”¨
- åç«¯çš„åŠ å¯†ç«¯ç‚¹åªæ˜¯ base64 ç¼–ç 

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. **å‰ç«¯**ï¼šåœ¨ `ChatRoom.jsx` ä¸­é›†æˆ `EncryptionService`
2. **åç«¯**ï¼šç§»é™¤ä¼ªåŠ å¯†ç«¯ç‚¹ï¼ŒåŠ å¯†åº”è¯¥åœ¨å®¢æˆ·ç«¯å®Œæˆï¼ˆç«¯åˆ°ç«¯ï¼‰
3. **æ™ºèƒ½åˆçº¦**ï¼šç¡®ä¿åˆçº¦å­˜å‚¨çš„æ˜¯åŠ å¯†å†…å®¹

**å·²æœ‰èµ„æº**ï¼š
- âœ… `frontend/src/services/EncryptionService.js` - å®Œæ•´å®ç°
- âœ… `frontend/src/services/AdvancedEncryptionService.js` - é«˜çº§åŠŸèƒ½

**éœ€è¦åšçš„**ï¼š
1. ä¿®æ”¹ `ChatRoom.jsx` ä½¿ç”¨åŠ å¯†æœåŠ¡
2. ç¡®ä¿å…¬é’¥åœ¨ç”¨æˆ·æ³¨å†Œæ—¶å­˜å‚¨åˆ°æ™ºèƒ½åˆçº¦
3. å‘é€æ¶ˆæ¯å‰åŠ å¯†ï¼Œæ¥æ”¶æ¶ˆæ¯åè§£å¯†

---

### 2.3 å®æ—¶æ¨é€æœªéƒ¨ç½²

**å½“å‰é—®é¢˜**ï¼š
- Socket.IO ä»£ç å·²å®ç°ä½†å¯èƒ½æœªåœ¨ç”Ÿäº§ç¯å¢ƒè¿è¡Œ
- å‰ç«¯å¯èƒ½æœªæ­£ç¡®è¿æ¥åˆ° Socket.IO æœåŠ¡å™¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®è®¤ Socket.IO æœåŠ¡å™¨éƒ¨ç½²çŠ¶æ€
2. é…ç½® Nginx åå‘ä»£ç†æ”¯æŒ WebSocket
3. å‰ç«¯è¿æ¥åˆ°æ­£ç¡®çš„ Socket.IO ç«¯ç‚¹

**å·²æœ‰èµ„æº**ï¼š
- âœ… `backend/src/socket_app.py` - Socket.IO åº”ç”¨
- âœ… `backend/src/socket_server.py` - æœåŠ¡å™¨é€»è¾‘
- âœ… `backend/deploy/nginx_socket_io.conf` - Nginx é…ç½®

**éœ€è¦åšçš„**ï¼š
1. éªŒè¯ Socket.IO æ˜¯å¦åœ¨è¿è¡Œ
2. é…ç½®ç¯å¢ƒå˜é‡å’Œç«¯å£
3. æµ‹è¯•å®æ—¶æ¶ˆæ¯æ¨é€

---

### 2.4 æ™ºèƒ½åˆçº¦éƒ¨ç½²éªŒè¯

**å½“å‰é—®é¢˜**ï¼š
- README ä¸­çš„åˆçº¦åœ°å€çœ‹èµ·æ¥åƒæœ¬åœ°æµ‹è¯•ç½‘åœ°å€
- å‰ç«¯é…ç½®çš„åˆçº¦åœ°å€ä¸ `deployment-v2-addresses.json` ä¸ä¸€è‡´

**åˆçº¦åœ°å€å¯¹æ¯”**ï¼š

| åˆçº¦ | å‰ç«¯é…ç½® | deployment-v2 | çŠ¶æ€ |
|------|---------|--------------|------|
| MessageStorage | 0x5a7f2f95... | 0x90662669... | âŒ ä¸ä¸€è‡´ |
| UserIdentity | 0x32a75De0... | 0x6BCF16f8... | âŒ ä¸ä¸€è‡´ |

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. éªŒè¯å“ªä¸ªåœ°å€æ˜¯çœŸå®éƒ¨ç½²çš„
2. æ›´æ–°å‰ç«¯é…ç½®æ–‡ä»¶
3. åœ¨ Sepolia Etherscan ä¸ŠéªŒè¯åˆçº¦ä»£ç 

**éœ€è¦å’¨è¯¢ç”¨æˆ·**ï¼š
- æ‚¨æ˜¯å¦å·²ç»å°†åˆçº¦éƒ¨ç½²åˆ° Sepolia æµ‹è¯•ç½‘ï¼Ÿ
- å¦‚æœå·²éƒ¨ç½²ï¼Œæ­£ç¡®çš„åˆçº¦åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ
- æ˜¯å¦éœ€è¦é‡æ–°éƒ¨ç½²åˆçº¦ï¼Ÿ

---

## ä¸‰ã€å¼€æºæ–¹æ¡ˆæœç´¢å’Œè¯„ä¼°

### 3.1 éœ€è¦æœç´¢çš„å¼€æºç»„ä»¶

æ ¹æ®ç¼ºå¤±åŠŸèƒ½ï¼Œæˆ‘éœ€è¦æœç´¢ä»¥ä¸‹å¼€æºæ–¹æ¡ˆï¼š

**P0 çº§åˆ«**ï¼š
1. âœ… Web3 ç­¾åéªŒè¯ - ä½¿ç”¨ `web3.py` æˆ– `eth-account`ï¼ˆPython æ ‡å‡†åº“ï¼‰
2. âœ… ç«¯åˆ°ç«¯åŠ å¯† - å‰ç«¯å·²æœ‰å®ç°ï¼Œæ— éœ€é¢å¤–ç»„ä»¶

**P1 çº§åˆ«**ï¼š
3. ğŸ” IPFS å®¢æˆ·ç«¯ - éœ€è¦æœç´¢ Python IPFS åº“
4. ğŸ” æ¶ˆæ¯é˜Ÿåˆ— - Redis + Celery æˆ–å…¶ä»–æ–¹æ¡ˆ
5. ğŸ” ç¼“å­˜å±‚ - Redis é›†æˆæ–¹æ¡ˆ
6. ğŸ” æ•°æ®åº“è¿ç§» - Alembicï¼ˆFlask-Migrateï¼‰

**P2 çº§åˆ«**ï¼š
7. ğŸ” é”™è¯¯ç›‘æ§ - Sentry SDK
8. ğŸ” æ—¥å¿—èšåˆ - å¼€æºæ–¹æ¡ˆï¼ˆELK æˆ– Lokiï¼‰
9. ğŸ” API é™æµ - Flask-Limiter
10. ğŸ” WebRTC - è¯­éŸ³/è§†é¢‘é€šè¯ï¼ˆå¯é€‰ï¼‰

---

## å››ã€æŠ€æœ¯é€‰å‹é—®é¢˜ï¼ˆéœ€è¦å’¨è¯¢ç”¨æˆ·ï¼‰

### 4.1 æ•°æ®åº“é€‰æ‹©

**å½“å‰çŠ¶æ€**ï¼š
- å¼€å‘ç¯å¢ƒï¼šSQLite
- ç”Ÿäº§ç¯å¢ƒï¼šå·²è¿ç§»åˆ° Supabase (PostgreSQL)

**é—®é¢˜**ï¼š
1. æ˜¯å¦ç»§ç»­ä½¿ç”¨ Supabaseï¼Ÿ
2. æ˜¯å¦éœ€è¦è‡ªå»º PostgreSQLï¼Ÿ
3. æ˜¯å¦éœ€è¦å®ç°æ•°æ®åº“è¯»å†™åˆ†ç¦»ï¼Ÿ

**å»ºè®®**ï¼šSupabase æ˜¯å¾ˆå¥½çš„é€‰æ‹©ï¼Œæä¾›äº†ï¼š
- PostgreSQL æ•°æ®åº“
- å®æ—¶è®¢é˜…åŠŸèƒ½ï¼ˆå¯æ›¿ä»£éƒ¨åˆ† Socket.IOï¼‰
- è®¤è¯æœåŠ¡
- å­˜å‚¨æœåŠ¡ï¼ˆå¯ç”¨äºæ–‡ä»¶ä¸Šä¼ ï¼‰

**å’¨è¯¢ç”¨æˆ·**ï¼šæ‚¨å¸Œæœ›ç»§ç»­ä½¿ç”¨ Supabase è¿˜æ˜¯è¿ç§»åˆ°è‡ªå»ºæ•°æ®åº“ï¼Ÿ

---

### 4.2 æ–‡ä»¶å­˜å‚¨æ–¹æ¡ˆ

**å½“å‰çŠ¶æ€**ï¼š
- å‰ç«¯æœ‰ `IPFSService.js`
- åç«¯æ—  IPFS é›†æˆ

**é€‰é¡¹**ï¼š

**é€‰é¡¹ Aï¼šIPFSï¼ˆå»ä¸­å¿ƒåŒ–ï¼‰**
- âœ… ç¬¦åˆ Web3 ç†å¿µ
- âœ… æ°¸ä¹…å­˜å‚¨
- âŒ ä¸Šä¼ é€Ÿåº¦æ…¢
- âŒ éœ€è¦è¿è¡Œ IPFS èŠ‚ç‚¹æˆ–ä½¿ç”¨ Pinata/Infura

**é€‰é¡¹ Bï¼šSupabase Storageï¼ˆä¸­å¿ƒåŒ–ï¼‰**
- âœ… å¿«é€Ÿå¯é 
- âœ… å·²æœ‰ Supabase è´¦æˆ·
- âœ… æ˜“äºé›†æˆ
- âŒ ä¸ç¬¦åˆå»ä¸­å¿ƒåŒ–ç†å¿µ

**é€‰é¡¹ Cï¼šæ··åˆæ–¹æ¡ˆ**
- å°æ–‡ä»¶/å¤´åƒ â†’ Supabase Storageï¼ˆå¿«é€Ÿï¼‰
- å¤§æ–‡ä»¶/é‡è¦æ–‡ä»¶ â†’ IPFSï¼ˆå»ä¸­å¿ƒåŒ–ï¼‰

**å’¨è¯¢ç”¨æˆ·**ï¼šæ‚¨æ›´å€¾å‘äºå“ªç§æ–‡ä»¶å­˜å‚¨æ–¹æ¡ˆï¼Ÿ

---

### 4.3 å®æ—¶é€šä¿¡æ¶æ„

**å½“å‰çŠ¶æ€**ï¼š
- å·²æœ‰ Socket.IO å®ç°
- Supabase æä¾›å®æ—¶è®¢é˜…åŠŸèƒ½

**é€‰é¡¹**ï¼š

**é€‰é¡¹ Aï¼šSocket.IOï¼ˆå½“å‰æ–¹æ¡ˆï¼‰**
- âœ… å·²æœ‰ä»£ç å®ç°
- âœ… åŠŸèƒ½å®Œæ•´
- âŒ éœ€è¦å•ç‹¬éƒ¨ç½²å’Œç»´æŠ¤
- âŒ å¢åŠ æ¶æ„å¤æ‚åº¦

**é€‰é¡¹ Bï¼šSupabase Realtime**
- âœ… æ— éœ€é¢å¤–éƒ¨ç½²
- âœ… ä¸æ•°æ®åº“é›†æˆ
- âœ… è‡ªåŠ¨æ‰©å±•
- âŒ åŠŸèƒ½å¯èƒ½ä¸å¦‚ Socket.IO çµæ´»

**é€‰é¡¹ Cï¼šæ··åˆæ–¹æ¡ˆ**
- æ¶ˆæ¯æ¨é€ â†’ Supabase Realtime
- åœ¨çº¿çŠ¶æ€/è¾“å…¥çŠ¶æ€ â†’ Socket.IO

**å’¨è¯¢ç”¨æˆ·**ï¼šæ‚¨å¸Œæœ›ä½¿ç”¨å“ªç§å®æ—¶é€šä¿¡æ–¹æ¡ˆï¼Ÿ

---

### 4.4 æ”¯ä»˜ç½‘å…³é€‰æ‹©

**å½“å‰çŠ¶æ€**ï¼š
- åç«¯å·²é›†æˆ Stripe
- æ™ºèƒ½åˆçº¦æœ‰æ”¯ä»˜æ‰˜ç®¡åŠŸèƒ½

**é—®é¢˜**ï¼š
1. æ˜¯å¦éœ€è¦æ”¯æŒæ³•å¸æ”¯ä»˜ï¼ˆStripeï¼‰ï¼Ÿ
2. æ˜¯å¦åªä½¿ç”¨åŠ å¯†è´§å¸æ”¯ä»˜ï¼Ÿ
3. æ˜¯å¦éœ€è¦æ”¯æŒå¤šç§æ”¯ä»˜æ–¹å¼ï¼Ÿ

**å’¨è¯¢ç”¨æˆ·**ï¼šæ‚¨çš„å•†ä¸šæ¨¡å¼éœ€è¦å“ªäº›æ”¯ä»˜æ–¹å¼ï¼Ÿ

---

### 4.5 éƒ¨ç½²æ¶æ„

**å½“å‰çŠ¶æ€**ï¼š
- å‰ç«¯ï¼šVercel
- åç«¯ï¼šæœªçŸ¥ï¼ˆå¯èƒ½æ˜¯ Vercel Serverless Functionsï¼‰

**é—®é¢˜**ï¼š
1. åç«¯æ˜¯å¦éƒ¨ç½²åœ¨ Vercelï¼Ÿ
2. æ˜¯å¦éœ€è¦è¿ç§»åˆ° VPS/äº‘æœåŠ¡å™¨ï¼Ÿ
3. Socket.IO å¦‚ä½•éƒ¨ç½²ï¼Ÿ

**å»ºè®®**ï¼š
- å‰ç«¯ï¼šç»§ç»­ä½¿ç”¨ Vercel
- åç«¯ APIï¼šVercel Serverless æˆ–ç‹¬ç«‹æœåŠ¡å™¨
- Socket.IOï¼šå¿…é¡»éƒ¨ç½²åœ¨ç‹¬ç«‹æœåŠ¡å™¨ï¼ˆVercel ä¸æ”¯æŒé•¿è¿æ¥ï¼‰
- æ•°æ®åº“ï¼šSupabase æ‰˜ç®¡
- ç¼“å­˜ï¼šRedis Cloud æˆ–è‡ªå»º

**å’¨è¯¢ç”¨æˆ·**ï¼šæ‚¨å½“å‰çš„åç«¯éƒ¨ç½²åœ¨å“ªé‡Œï¼Ÿæ˜¯å¦æœ‰é¢„ç®—ç§Ÿç”¨ç‹¬ç«‹æœåŠ¡å™¨ï¼Ÿ

---

## äº”ã€å®æ–½è®¡åˆ’

### Phase 1: P0 çº§ä¿®å¤ï¼ˆ1-2 å‘¨ï¼‰

**1.1 ä¿®å¤ç­¾åéªŒè¯**
- [ ] å®ç° Web3 ç­¾åéªŒè¯
- [ ] æ·»åŠ  nonce ç®¡ç†
- [ ] æµ‹è¯•é’±åŒ…ç™»å½•æµç¨‹

**1.2 é›†æˆåŠ å¯†åŠŸèƒ½**
- [ ] ä¿®æ”¹ ChatRoom.jsx ä½¿ç”¨ EncryptionService
- [ ] ç¡®ä¿å…¬é’¥å­˜å‚¨åˆ°æ™ºèƒ½åˆçº¦
- [ ] æµ‹è¯•ç«¯åˆ°ç«¯åŠ å¯†

**1.3 éƒ¨ç½²å®æ—¶æ¨é€**
- [ ] ç¡®è®¤ Socket.IO éƒ¨ç½²æ–¹æ¡ˆ
- [ ] é…ç½® Nginx/åå‘ä»£ç†
- [ ] æµ‹è¯•å®æ—¶æ¶ˆæ¯æ¨é€

**1.4 éªŒè¯æ™ºèƒ½åˆçº¦**
- [ ] ç¡®è®¤åˆçº¦åœ°å€
- [ ] æ›´æ–°å‰ç«¯é…ç½®
- [ ] åœ¨ Etherscan éªŒè¯åˆçº¦

---

### Phase 2: P1 çº§åŠŸèƒ½é›†æˆï¼ˆ2-3 å‘¨ï¼‰

**2.1 æ–‡ä»¶ä¼ è¾“**
- [ ] é€‰æ‹©æ–‡ä»¶å­˜å‚¨æ–¹æ¡ˆï¼ˆå¾…ç”¨æˆ·ç¡®è®¤ï¼‰
- [ ] é›†æˆ IPFS æˆ– Supabase Storage
- [ ] å®ç°æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½ API
- [ ] å‰ç«¯é›†æˆæ–‡ä»¶ä¼ è¾“åŠŸèƒ½

**2.2 ç¾¤ç»„èŠå¤©**
- [ ] å¯ç”¨å‰ç«¯ GroupService
- [ ] å®ç°åç«¯ç¾¤ç»„ API
- [ ] æµ‹è¯•ç¾¤ç»„æ¶ˆæ¯åŠŸèƒ½

**2.3 æ¶ˆæ¯çŠ¶æ€**
- [ ] ä¿®å¤å·²è¯»çŠ¶æ€ï¼ˆç§»é™¤ç¡¬ç¼–ç çš„ 0ï¼‰
- [ ] å®ç°æ¶ˆæ¯çŠ¶æ€æ›´æ–°
- [ ] æ·»åŠ æ¶ˆæ¯é€è¾¾å›æ‰§

---

### Phase 3: åç«¯æ¶æ„ä¼˜åŒ–ï¼ˆ2-3 å‘¨ï¼‰

**3.1 ç¼“å­˜å±‚**
- [ ] é›†æˆ Redis
- [ ] ç¼“å­˜ç”¨æˆ·ä¿¡æ¯
- [ ] ç¼“å­˜å¯¹è¯åˆ—è¡¨

**3.2 æ•°æ®åº“ä¼˜åŒ–**
- [ ] é›†æˆ Alembic è¿ç§»å·¥å…·
- [ ] æ·»åŠ æ•°æ®åº“ç´¢å¼•
- [ ] ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½

**3.3 ç›‘æ§å’Œæ—¥å¿—**
- [ ] é›†æˆ Sentry é”™è¯¯ç›‘æ§
- [ ] é…ç½®æ—¥å¿—èšåˆ
- [ ] æ·»åŠ æ€§èƒ½ç›‘æ§

**3.4 å®‰å…¨åŠ å›º**
- [ ] å®ç° API é™æµ
- [ ] æ·»åŠ  CSRF ä¿æŠ¤
- [ ] è¾“å…¥éªŒè¯å’Œ XSS é˜²æŠ¤

---

## å…­ã€å¾…ç¡®è®¤çš„æŠ€æœ¯å†³ç­–

è¯·æ‚¨ç¡®è®¤ä»¥ä¸‹æŠ€æœ¯é€‰å‹ï¼Œä»¥ä¾¿æˆ‘ç»§ç»­å®æ–½ï¼š

### å…³é”®å†³ç­–ç‚¹ï¼š

1. **æ•°æ®åº“**ï¼šç»§ç»­ä½¿ç”¨ Supabase è¿˜æ˜¯è¿ç§»åˆ°è‡ªå»º PostgreSQLï¼Ÿ
2. **æ–‡ä»¶å­˜å‚¨**ï¼šIPFS / Supabase Storage / æ··åˆæ–¹æ¡ˆï¼Ÿ
3. **å®æ—¶é€šä¿¡**ï¼šSocket.IO / Supabase Realtime / æ··åˆæ–¹æ¡ˆï¼Ÿ
4. **æ”¯ä»˜æ–¹å¼**ï¼šStripeï¼ˆæ³•å¸ï¼‰/ ä»…åŠ å¯†è´§å¸ / ä¸¤è€…éƒ½è¦ï¼Ÿ
5. **éƒ¨ç½²æ¶æ„**ï¼šå½“å‰åç«¯éƒ¨ç½²åœ¨å“ªé‡Œï¼Ÿæ˜¯å¦æœ‰é¢„ç®—ç§Ÿç”¨æœåŠ¡å™¨ï¼Ÿ
6. **æ™ºèƒ½åˆçº¦**ï¼šåˆçº¦æ˜¯å¦å·²éƒ¨ç½²ï¼Ÿæ­£ç¡®çš„åœ°å€æ˜¯ä»€ä¹ˆï¼Ÿ

### æ¬¡è¦å†³ç­–ç‚¹ï¼š

7. **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šæ˜¯å¦éœ€è¦ Celery + Redis å¤„ç†å¼‚æ­¥ä»»åŠ¡ï¼Ÿ
8. **CDN**ï¼šæ˜¯å¦éœ€è¦é…ç½® CDN åŠ é€Ÿé™æ€èµ„æºï¼Ÿ
9. **åŸŸåå’Œ SSL**ï¼šåŸŸåé…ç½®æ˜¯å¦å®Œæˆï¼ŸSSL è¯ä¹¦æ˜¯å¦æœ‰æ•ˆï¼Ÿ
10. **ç›‘æ§å·¥å…·**ï¼šæ˜¯å¦æœ‰ Sentry è´¦æˆ·ï¼Ÿæ˜¯å¦éœ€è¦å…¶ä»–ç›‘æ§å·¥å…·ï¼Ÿ

---

## ä¸ƒã€å¼€æºç»„ä»¶æœç´¢æ¸…å•

æˆ‘å°†æœç´¢ä»¥ä¸‹å¼€æºç»„ä»¶ï¼ˆå¦‚æœæ‚¨ç¡®è®¤éœ€è¦ï¼‰ï¼š

### ç¡®å®šéœ€è¦çš„ï¼š
- [ ] `web3.py` / `eth-account` - Web3 ç­¾åéªŒè¯
- [ ] `Flask-Limiter` - API é™æµ
- [ ] `Alembic` / `Flask-Migrate` - æ•°æ®åº“è¿ç§»
- [ ] `Sentry SDK` - é”™è¯¯ç›‘æ§

### å¾…ç¡®è®¤çš„ï¼š
- [ ] `ipfshttpclient` - Python IPFS å®¢æˆ·ç«¯ï¼ˆå¦‚æœé€‰æ‹© IPFSï¼‰
- [ ] `Celery` + `Redis` - æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚æœéœ€è¦å¼‚æ­¥ä»»åŠ¡ï¼‰
- [ ] `Flask-Caching` - ç¼“å­˜é›†æˆï¼ˆå¦‚æœé€‰æ‹© Redisï¼‰
- [ ] `simple-websocket` - WebRTC ä¿¡ä»¤æœåŠ¡å™¨ï¼ˆå¦‚æœéœ€è¦éŸ³è§†é¢‘é€šè¯ï¼‰

---

## å…«ã€ä¸‹ä¸€æ­¥è¡ŒåŠ¨

è¯·æ‚¨å›ç­”ä¸Šè¿°å…³é”®å†³ç­–ç‚¹ï¼Œæˆ‘å°†ï¼š

1. æœç´¢å’Œè¯„ä¼°ç›¸åº”çš„å¼€æºæ–¹æ¡ˆ
2. å¼€å§‹ä¿®å¤ P0 çº§è‡´å‘½ç¼ºé™·
3. é€æ­¥é›†æˆç¼ºå¤±åŠŸèƒ½
4. ä¼˜åŒ–åç«¯æ¶æ„
5. æä¾›å®Œæ•´çš„éƒ¨ç½²æŒ‡å—

**é¢„è®¡æ€»æ—¶é—´**ï¼š6-8 å‘¨ï¼ˆå–å†³äºæŠ€æœ¯é€‰å‹å’ŒåŠŸèƒ½èŒƒå›´ï¼‰

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´**ï¼š2025-11-04  
**ä½œè€…**ï¼šManus AI


---


# AWS Deployment Guide for dchat.pro

## Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CloudFront    â”‚  (CDN for frontend)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   S3 Bucket     â”‚  (Frontend static files)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Route 53 DNS   â”‚  (dchat.pro domain)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Load Balancer  â”‚  (ALB)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”
â”‚ EC2  â”‚  â”‚ EC2  â”‚  (Backend API + Socket.IO)
â””â”€â”€â”€â”¬â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜
    â”‚        â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ElastiCache    â”‚  (Redis)
â”‚   (Redis 7.x)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RDS/TiDB      â”‚  (PostgreSQL/TiDB)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pinata IPFS    â”‚  (File storage)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Prerequisites

1. AWS Account with appropriate permissions
2. AWS CLI installed and configured
3. Domain name (dchat.pro) configured in Route 53
4. SSH key pair (protocol-bank-key.pem)

## Step 1: Create VPC and Security Groups

### VPC Configuration
```bash
# Create VPC
aws ec2 create-vpc --cidr-block 10.0.0.0/16 --tag-specifications 'ResourceType=vpc,Tags=[{Key=Name,Value=dchat-vpc}]'

# Create subnets (public and private)
aws ec2 create-subnet --vpc-id <VPC_ID> --cidr-block 10.0.1.0/24 --availability-zone us-east-1a --tag-specifications 'ResourceType=subnet,Tags=[{Key=Name,Value=dchat-public-1a}]'
aws ec2 create-subnet --vpc-id <VPC_ID> --cidr-block 10.0.2.0/24 --availability-zone us-east-1b --tag-specifications 'ResourceType=subnet,Tags=[{Key=Name,Value=dchat-public-1b}]'
```

### Security Groups

**Backend Security Group**
```bash
aws ec2 create-security-group \
  --group-name dchat-backend-sg \
  --description "Security group for dchat backend" \
  --vpc-id <VPC_ID>

# Allow SSH (22)
aws ec2 authorize-security-group-ingress \
  --group-id <SG_ID> \
  --protocol tcp \
  --port 22 \
  --cidr 0.0.0.0/0

# Allow HTTP (8000 - API)
aws ec2 authorize-security-group-ingress \
  --group-id <SG_ID> \
  --protocol tcp \
  --port 8000 \
  --cidr 0.0.0.0/0

# Allow Socket.IO (3002)
aws ec2 authorize-security-group-ingress \
  --group-id <SG_ID> \
  --protocol tcp \
  --port 3002 \
  --cidr 0.0.0.0/0

# Allow HTTPS (443)
aws ec2 authorize-security-group-ingress \
  --group-id <SG_ID> \
  --protocol tcp \
  --port 443 \
  --cidr 0.0.0.0/0
```

**Redis Security Group**
```bash
aws ec2 create-security-group \
  --group-name dchat-redis-sg \
  --description "Security group for dchat Redis" \
  --vpc-id <VPC_ID>

# Allow Redis (6379) from backend SG only
aws ec2 authorize-security-group-ingress \
  --group-id <REDIS_SG_ID> \
  --protocol tcp \
  --port 6379 \
  --source-group <BACKEND_SG_ID>
```

## Step 2: Launch EC2 Instances

### EC2 Instance Specifications
- **Instance Type**: t3.medium (2 vCPU, 4 GB RAM)
- **OS**: Ubuntu 22.04 LTS
- **Storage**: 30 GB gp3 SSD
- **Key Pair**: protocol-bank-key.pem

### Launch Command
```bash
aws ec2 run-instances \
  --image-id ami-0c7217cdde317cfec \
  --instance-type t3.medium \
  --key-name protocol-bank-key \
  --security-group-ids <BACKEND_SG_ID> \
  --subnet-id <PUBLIC_SUBNET_ID> \
  --block-device-mappings '[{"DeviceName":"/dev/sda1","Ebs":{"VolumeSize":30,"VolumeType":"gp3"}}]' \
  --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=dchat-backend-1}]' \
  --user-data file://user-data.sh
```

### User Data Script (user-data.sh)
```bash
#!/bin/bash
set -e

# Update system
apt-get update
apt-get upgrade -y

# Install Node.js 20.x
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt-get install -y nodejs

# Install Python 3.11
apt-get install -y python3.11 python3.11-venv python3-pip

# Install Git
apt-get install -y git

# Install Docker (for future use)
apt-get install -y docker.io
systemctl enable docker
systemctl start docker

# Install PM2 globally
npm install -g pm2

# Create application user
useradd -m -s /bin/bash dchat
usermod -aG sudo dchat

# Clone repository
cd /home/dchat
sudo -u dchat git clone https://github.com/everest-an/dchat.git
cd dchat

# Setup backend
cd backend
sudo -u dchat python3.11 -m venv venv
sudo -u dchat ./venv/bin/pip install -r requirements.txt

# Setup environment variables (will be configured later)
sudo -u dchat cp .env.example .env

# Install frontend dependencies (for build)
cd ../frontend
sudo -u dchat npm install

echo "Setup complete!"
```

## Step 3: Create ElastiCache Redis Cluster

```bash
aws elasticache create-cache-cluster \
  --cache-cluster-id dchat-redis \
  --cache-node-type cache.t3.micro \
  --engine redis \
  --engine-version 7.0 \
  --num-cache-nodes 1 \
  --cache-subnet-group-name dchat-redis-subnet-group \
  --security-group-ids <REDIS_SG_ID> \
  --tags Key=Name,Value=dchat-redis
```

### Get Redis Endpoint
```bash
aws elasticache describe-cache-clusters \
  --cache-cluster-id dchat-redis \
  --show-cache-node-info \
  --query 'CacheClusters[0].CacheNodes[0].Endpoint.Address' \
  --output text
```

## Step 4: Configure Application Load Balancer

```bash
# Create ALB
aws elbv2 create-load-balancer \
  --name dchat-alb \
  --subnets <SUBNET_1> <SUBNET_2> \
  --security-groups <ALB_SG_ID> \
  --tags Key=Name,Value=dchat-alb

# Create target group for backend
aws elbv2 create-target-group \
  --name dchat-backend-tg \
  --protocol HTTP \
  --port 8000 \
  --vpc-id <VPC_ID> \
  --health-check-path /health \
  --health-check-interval-seconds 30

# Register EC2 instances
aws elbv2 register-targets \
  --target-group-arn <TG_ARN> \
  --targets Id=<INSTANCE_ID_1> Id=<INSTANCE_ID_2>

# Create listener
aws elbv2 create-listener \
  --load-balancer-arn <ALB_ARN> \
  --protocol HTTPS \
  --port 443 \
  --certificates CertificateArn=<ACM_CERT_ARN> \
  --default-actions Type=forward,TargetGroupArn=<TG_ARN>
```

## Step 5: Deploy Application

### SSH into EC2
```bash
chmod 400 protocol-bank-key.pem
ssh -i protocol-bank-key.pem ubuntu@<EC2_PUBLIC_IP>
```

### Configure Environment Variables
```bash
cd /home/dchat/dchat/backend
sudo nano .env
```

Add the following:
```env
# Database Configuration (TiDB)
DB_HOST=gateway01.eu-central-1.prod.aws.tidbcloud.com
DB_PORT=4000
DB_USER=3weSfx6NGnayDMr.root
DB_PASSWORD=<YOUR_PASSWORD>
DB_NAME=test

# JWT Secret
JWT_SECRET=<GENERATE_STRONG_SECRET>

# Pinata IPFS
PINATA_JWT=<YOUR_PINATA_JWT>
PINATA_API_KEY=p650Qa8dd0e3c8f2a03Q
PINATA_SECRET_API_KEY=bca8e0dbc67c7da8d4ee3feb187eeb0c548cc8f58cc019718ed3b
PINATA_GATEWAY_URL=https://gateway.pinata.cloud/ipfs/

# Redis (ElastiCache endpoint)
REDIS_URL=redis://<REDIS_ENDPOINT>:6379

# Web3
WEB3_PROVIDER_URL=https://sepolia.infura.io/v3/<YOUR_INFURA_KEY>
CONTRACT_USER_IDENTITY=0x6BCF16f82F8d3A37b7b6fd59DeE9adf95B1BA5a1
CONTRACT_MESSAGE_STORAGE=0x906626694a065bEECf51F2C776f272bDB67Ce174

# Frontend URL
FRONTEND_URL=https://dchat.pro

# Socket.IO
SOCKET_IO_PORT=3002
SOCKET_IO_CORS_ORIGIN=https://dchat.pro
```

### Start Backend with PM2
```bash
cd /home/dchat/dchat/backend

# Start Python backend
pm2 start src/main.py --name dchat-api --interpreter python3.11

# Start Socket.IO server
pm2 start src/socket_app.py --name dchat-socket --interpreter python3.11

# Save PM2 configuration
pm2 save
pm2 startup
```

### Build and Deploy Frontend
```bash
cd /home/dchat/dchat/frontend

# Update API endpoint
nano .env.production
```

Add:
```env
REACT_APP_API_URL=https://api.dchat.pro
REACT_APP_SOCKET_URL=https://socket.dchat.pro
REACT_APP_WEB3_PROVIDER=https://sepolia.infura.io/v3/<YOUR_INFURA_KEY>
```

```bash
# Build frontend
npm run build

# Upload to S3
aws s3 sync build/ s3://dchat-frontend-bucket/ --delete
aws s3 website s3://dchat-frontend-bucket/ --index-document index.html --error-document index.html
```

## Step 6: Configure CloudFront

```bash
aws cloudfront create-distribution \
  --origin-domain-name dchat-frontend-bucket.s3.amazonaws.com \
  --default-root-object index.html \
  --aliases dchat.pro www.dchat.pro
```

## Step 7: Update Route 53 DNS

```bash
# Point dchat.pro to CloudFront
aws route53 change-resource-record-sets \
  --hosted-zone-id <ZONE_ID> \
  --change-batch file://dns-changes.json
```

## Monitoring and Logging

### CloudWatch Logs
```bash
# Install CloudWatch agent on EC2
wget https://s3.amazonaws.com/amazoncloudwatch-agent/ubuntu/amd64/latest/amazon-cloudwatch-agent.deb
sudo dpkg -i amazon-cloudwatch-agent.deb

# Configure log groups
aws logs create-log-group --log-group-name /dchat/backend
aws logs create-log-group --log-group-name /dchat/socket
```

### PM2 Monitoring
```bash
pm2 monit
pm2 logs
```

## Backup and Disaster Recovery

### Database Backups
- TiDB Cloud handles automatic backups
- Configure retention period in TiDB console

### Redis Backups
```bash
aws elasticache create-snapshot \
  --cache-cluster-id dchat-redis \
  --snapshot-name dchat-redis-backup-$(date +%Y%m%d)
```

## Cost Estimation

| Service | Configuration | Monthly Cost (USD) |
|---------|--------------|-------------------|
| EC2 (t3.medium Ã— 2) | 2 vCPU, 4GB RAM | ~$60 |
| ElastiCache (t3.micro) | Redis 7.x | ~$15 |
| ALB | Application Load Balancer | ~$20 |
| S3 + CloudFront | Frontend hosting | ~$5 |
| Data Transfer | ~100GB/month | ~$10 |
| **Total** | | **~$110/month** |

## Security Checklist

- [ ] Enable AWS WAF on ALB
- [ ] Configure SSL/TLS certificates (ACM)
- [ ] Enable VPC Flow Logs
- [ ] Set up CloudTrail for audit logging
- [ ] Configure IAM roles with least privilege
- [ ] Enable MFA for AWS root account
- [ ] Rotate secrets regularly (use AWS Secrets Manager)
- [ ] Enable encryption at rest for EBS volumes
- [ ] Configure security groups with minimal access
- [ ] Set up automated security scanning

## Troubleshooting

### Check Backend Status
```bash
pm2 status
pm2 logs dchat-api --lines 100
```

### Check Redis Connection
```bash
redis-cli -h <REDIS_ENDPOINT> ping
```

### Check Database Connection
```bash
psql -h gateway01.eu-central-1.prod.aws.tidbcloud.com -p 4000 -U 3weSfx6NGnayDMr.root -d test
```

### Check Load Balancer Health
```bash
aws elbv2 describe-target-health --target-group-arn <TG_ARN>
```

## Next Steps

1. Set up CI/CD pipeline with GitHub Actions
2. Configure auto-scaling for EC2 instances
3. Implement blue-green deployment
4. Set up Sentry for error tracking
5. Configure Prometheus + Grafana for metrics
6. Implement rate limiting with AWS WAF
7. Set up automated backups
8. Configure alerting with SNS

## Support

For deployment issues, contact: everest9812@gmail.com


---


# dchat.pro Web3 API Documentation

## Overview

dchat.pro provides two sets of APIs:
1. **Traditional APIs** (`/api/*`) - Database-backed, centralized
2. **Web3 APIs** (`/api/web3/*`) - Smart contract-backed, decentralized

This document focuses on the **Web3 APIs** that integrate with Ethereum smart contracts deployed on Sepolia testnet.

---

## Base URL

```
Production: https://api.dchat.pro
Development: http://localhost:5000
```

---

## Authentication

All Web3 API endpoints require JWT authentication.

### Get JWT Token

1. Request a nonce:
```bash
POST /api/auth/nonce
Content-Type: application/json

{
  "address": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb"
}
```

Response:
```json
{
  "nonce": "Sign this message to authenticate: 1234567890",
  "expiresAt": "2025-11-04T17:00:00Z"
}
```

2. Sign the nonce with MetaMask/Web3 wallet

3. Verify signature and get JWT:
```bash
POST /api/auth/verify-signature
Content-Type: application/json

{
  "address": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
  "signature": "0x..."
}
```

Response:
```json
{
  "success": true,
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "address": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb"
  }
}
```

### Using JWT Token

Include the JWT token in the `Authorization` header:

```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

---

## Web3 Group Management API

Base path: `/api/web3/groups`

Smart Contract: `GroupChatV2` at `0x4f93AEaAE5981fd6C95cFA8096D31D3d92ae2F28`

### Create Group

```bash
POST /api/web3/groups/create
Authorization: Bearer <token>
Content-Type: application/json

{
  "groupName": "Tech Enthusiasts",
  "groupAvatar": "ipfs://QmXxxx...",
  "description": "A group for tech lovers",
  "isPublic": true,
  "maxMembers": 100,
  "privateKey": "0x..." // User's private key for signing transaction
}
```

Response:
```json
{
  "success": true,
  "transactionHash": "0xabc123...",
  "message": "Group created successfully",
  "blockNumber": 12345
}
```

### Get Group Information

```bash
GET /api/web3/groups/<group_id>
Authorization: Bearer <token>
```

Response:
```json
{
  "success": true,
  "group": {
    "groupId": "group_123",
    "groupName": "Tech Enthusiasts",
    "groupAvatar": "ipfs://QmXxxx...",
    "description": "A group for tech lovers",
    "owner": "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb",
    "members": ["0x...", "0x..."],
    "admins": ["0x..."],
    "createdAt": 1699123456,
    "memberCount": 10,
    "isActive": true
  }
}
```

### Join Group

```bash
POST /api/web3/groups/<group_id>/join
Authorization: Bearer <token>
Content-Type: application/json

{
  "privateKey": "0x..."
}
```

### Invite Member

```bash
POST /api/web3/groups/<group_id>/invite
Authorization: Bearer <token>
Content-Type: application/json

{
  "memberAddress": "0x...",
  "privateKey": "0x..."
}
```

### Leave Group

```bash
POST /api/web3/groups/<group_id>/leave
Authorization: Bearer <token>
Content-Type: application/json

{
  "privateKey": "0x..."
}
```

### Remove Member (Admin Only)

```bash
DELETE /api/web3/groups/<group_id>/members/<member_address>
Authorization: Bearer <token>
Content-Type: application/json

{
  "privateKey": "0x..."
}
```

### Update Group Settings (Owner Only)

```bash
PUT /api/web3/groups/<group_id>/settings
Authorization: Bearer <token>
Content-Type: application/json

{
  "isPublic": true,
  "allowMemberInvite": true,
  "requireApproval": false,
  "maxMembers": 200,
  "muteAll": false,
  "privateKey": "0x..."
}
```

### Get User's Groups

```bash
GET /api/web3/groups/user/<user_address>
Authorization: Bearer <token>
```

Response:
```json
{
  "success": true,
  "userAddress": "0x...",
  "groupIds": ["group_1", "group_2"],
  "groupCount": 2
}
```

### Get Group Members

```bash
GET /api/web3/groups/<group_id>/members
Authorization: Bearer <token>
```

---

## Web3 Payment API

Base path: `/api/web3/payments`

Smart Contracts:
- `GroupPayment` at `0x788Ba6e9B0EB746F58E4bab891B9c0add8359541`
- `RedPacket` at `0x0354fCfB243639d37F84E8d00031422655219f75`

### Group Collection

Create a group collection where members can contribute any amount.

```bash
POST /api/web3/payments/group-collection
Authorization: Bearer <token>
Content-Type: application/json

{
  "groupId": "group_123",
  "title": "Team Dinner Fund",
  "description": "Collecting money for team dinner",
  "participants": ["0x...", "0x..."],
  "privateKey": "0x..."
}
```

### AA Payment (Split Bill)

Create an AA payment where each participant pays an equal amount.

```bash
POST /api/web3/payments/aa-payment
Authorization: Bearer <token>
Content-Type: application/json

{
  "groupId": "group_123",
  "title": "Restaurant Bill",
  "description": "Split dinner cost",
  "participants": ["0x...", "0x..."],
  "amountPerPerson": "0.01",
  "privateKey": "0x..."
}
```

### Crowdfunding

Create a crowdfunding campaign with a target amount and deadline.

```bash
POST /api/web3/payments/crowdfunding
Authorization: Bearer <token>
Content-Type: application/json

{
  "groupId": "group_123",
  "title": "Team Building Fund",
  "description": "Raising money for team building",
  "targetAmount": "1.0",
  "deadline": 1735689600,
  "initialContribution": "0.1",
  "privateKey": "0x..."
}
```

### Contribute to Payment

```bash
POST /api/web3/payments/contribute/<payment_id>
Authorization: Bearer <token>
Content-Type: application/json

{
  "amount": "0.1",
  "privateKey": "0x..."
}
```

### Get Payment Details

```bash
GET /api/web3/payments/payment/<payment_id>
Authorization: Bearer <token>
```

Response:
```json
{
  "success": true,
  "payment": {
    "paymentId": "payment_123",
    "groupId": "group_123",
    "title": "Team Dinner Fund",
    "description": "Collecting money for team dinner",
    "creator": "0x...",
    "totalAmount": "0.5",
    "targetAmount": "1.0",
    "amountPerPerson": "0.0",
    "participantCount": 5,
    "createdAt": 1699123456,
    "deadline": 1735689600,
    "paymentType": 0,
    "isCompleted": false,
    "isActive": true
  }
}
```

---

## Red Packet API

Base path: `/api/web3/payments/redpacket`

### Create Random Red Packet

Create a red packet with random amounts (luck-based).

```bash
POST /api/web3/payments/redpacket/random
Authorization: Bearer <token>
Content-Type: application/json

{
  "groupId": "group_123",
  "message": "Happy New Year! ğŸ§§",
  "count": 10,
  "totalAmount": "0.1",
  "privateKey": "0x..."
}
```

### Create Fixed Red Packet

Create a red packet with equal amounts for each recipient.

```bash
POST /api/web3/payments/redpacket/fixed
Authorization: Bearer <token>
Content-Type: application/json

{
  "groupId": "group_123",
  "message": "Happy New Year! ğŸ§§",
  "count": 10,
  "totalAmount": "0.1",
  "privateKey": "0x..."
}
```

### Create Exclusive Red Packet

Create a red packet for specific recipients only.

```bash
POST /api/web3/payments/redpacket/exclusive
Authorization: Bearer <token>
Content-Type: application/json

{
  "groupId": "group_123",
  "message": "Special gift! ğŸ",
  "recipients": ["0x...", "0x..."],
  "totalAmount": "0.1",
  "privateKey": "0x..."
}
```

### Claim Red Packet

```bash
POST /api/web3/payments/redpacket/claim/<packet_id>
Authorization: Bearer <token>
Content-Type: application/json

{
  "privateKey": "0x..."
}
```

Response:
```json
{
  "success": true,
  "transactionHash": "0xabc123...",
  "message": "Red packet claimed successfully"
}
```

### Get Red Packet Details

```bash
GET /api/web3/payments/redpacket/<packet_id>
Authorization: Bearer <token>
```

Response:
```json
{
  "success": true,
  "packet": {
    "packetId": "packet_123",
    "groupId": "group_123",
    "message": "Happy New Year! ğŸ§§",
    "sender": "0x...",
    "totalAmount": "0.1",
    "remainingAmount": "0.05",
    "count": 10,
    "claimedCount": 5,
    "createdAt": 1699123456,
    "expiresAt": 1699209856,
    "packetType": 0,
    "isActive": true
  }
}
```

### Get Claim Records

```bash
GET /api/web3/payments/redpacket/<packet_id>/records
Authorization: Bearer <token>
```

Response:
```json
{
  "success": true,
  "packetId": "packet_123",
  "records": [
    {
      "claimer": "0x...",
      "amount": "0.012",
      "timestamp": 1699123456
    }
  ],
  "totalClaimed": 5
}
```

---

## Health Check

Check API and blockchain connection status.

```bash
GET /api/web3/groups/health
GET /api/web3/payments/health
```

Response:
```json
{
  "status": "healthy",
  "service": "groups-web3-api",
  "contract": "0x4f93AEaAE5981fd6C95cFA8096D31D3d92ae2F28",
  "network": "sepolia",
  "connected": true,
  "blockNumber": 12345
}
```

---

## Error Handling

All API responses follow a consistent format:

### Success Response
```json
{
  "success": true,
  "data": { ... }
}
```

### Error Response
```json
{
  "success": false,
  "error": "Error message"
}
```

### Common HTTP Status Codes

- `200 OK` - Request succeeded
- `201 Created` - Resource created successfully
- `400 Bad Request` - Invalid request parameters
- `401 Unauthorized` - Missing or invalid authentication token
- `403 Forbidden` - Insufficient permissions
- `404 Not Found` - Resource not found
- `500 Internal Server Error` - Server error
- `503 Service Unavailable` - Blockchain connection failed

---

## Gas Fees

All blockchain transactions require gas fees (paid in ETH on Sepolia testnet).

**Estimated Gas Costs**:
- Create Group: ~0.005 ETH
- Join Group: ~0.002 ETH
- Create Payment: ~0.004 ETH
- Contribute: ~0.002 ETH
- Create Red Packet: ~0.004 ETH
- Claim Red Packet: ~0.002 ETH

**Note**: Gas prices vary based on network congestion. The API automatically estimates gas and includes it in transactions.

---

## Rate Limiting

- **Authenticated requests**: 100 requests per minute
- **Unauthenticated requests**: 20 requests per minute

Rate limit headers are included in responses:
```
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1699123456
```

---

## Security Best Practices

1. **Never expose private keys**: Private keys should only be used client-side for signing transactions
2. **Use HTTPS**: Always use HTTPS in production
3. **Validate signatures**: All transactions are verified on-chain
4. **Token expiration**: JWT tokens expire after 24 hours
5. **Gas limit protection**: Transactions have maximum gas limits to prevent excessive fees

---

## Testing

### Sepolia Testnet

All contracts are deployed on Sepolia testnet. Get free test ETH from:
- https://sepoliafaucet.com
- https://faucet.sepolia.dev

### Example cURL Request

```bash
# Get group information
curl -X GET "https://api.dchat.pro/api/web3/groups/group_123" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

---

## Support

For API support, please contact:
- Email: everest9812@gmail.com
- GitHub: https://github.com/everest-an/dchat

---

## Changelog

### v2.0.0 (2025-11-04)
- Added Web3 group management API
- Added group payment and AA payment API
- Added red packet system API
- Integrated with GroupChatV2, GroupPayment, and RedPacket smart contracts
- JWT authentication for all endpoints
- Health check endpoints

### v1.0.0 (2024-10-20)
- Initial API release
- Basic authentication
- Traditional database-backed APIs
